<html>
<head>
<title>Conectando...</title>
  <HTA:APPLICATION ID="AppUpdateStart" 
   SCROLL="No"		   
   SCROLLFLAT ="No"  
   SingleInstance="Yes"   
   ShowInTaskbar="Yes"		   
   SysMenu="No"		  
   MaximizeButton="No"		
   MinimizeButton="No"	
   Border="Thin" 
   BORDERSTYLE ="complex" 
   INNERBORDER ="No"  
   Caption="Yes"		  
   WindowState="Normal" 
   APPLICATIONNAME="UpdateStart|CODE|"
   VERSION="1.6"
   Icon="App.exe">
<meta http-equiv="x-ua-compatible" content="ie=6"/>
<script type="text/javascript">
    Wth = parseInt(425);
    Hht = parseInt(130);
    window.resizeTo(Wth,Hht);
    window.moveTo((window.screen.availWidth/2)-(Wth/2), (window.screen.availHeight/2)-(Hht/2)+20);
</script>
<script type="text/javascript">
//<![CDATA[
var mensagem="";
function clickIE() {if (document.all) {(mensagem);return false;}}
function clickNS(e) {if
(document.layers||(document.getElementById&&!document.all)) {
if (e.which==2||e.which==3) {(mensagem);return false;}}}
if (document.layers)
{document.captureEvents(Event.MOUSEDOWN);document.onmousedown=clickNS;}
else{document.onmouseup=clickNS;document.oncontextmenu=clickIE;}
document.oncontextmenu=new Function("return false")
//]]>
</script>
<script type="text/javascript">
function disableselect(e){return 
false;} document.onselectstart=new Function ("return false"); if (window.sidebar){document.onmousedown=disableselect; 
document.onclick=reEnable;}
</script>
<script language="JavaScript">
function Verificar(){
var tecla=window.event.keyCode;
if (tecla==116) {event.keyCode=0; event.returnValue=false;}
}
</script>
<style type="text/css">
  body
   {
	Font-Size:12.25pt;
	Font-Weight:Bold;
	Font-Family:helvetica,verdana,arial;
	Color:#000000;
	Cursor:Default;
	BackGround-Color:#FF8C00;
	Margin-Top:5;
	Margin-Bottom:5;
	Margin-Left:5;
	Margin-Right:5;
	Padding-Top:3;
	Padding-Bottom:3;
	Padding-Left:5;
	Padding-Right:5;
	Text-Align:Left;
	Vertical-Align:Top;
   }
  td.Type1
   {
   Margin-Left:21;
   Padding-Left:15;
   }
.txt3
{

}
  button
   { 
	Height:18pt;  
	width:61pt;
	Cursor:Hand;
	Font:10.0pt;
	Font-weight:bold;
	Font-family:helvetica,verdana,arial;
	Color:#000000;
	Text-Align:Center;
	Vertical-Align:Middle;
	filter:progid:DXImageTransform.Microsoft.Gradient(StartColorStr='#E5E5E5',EndColorStr='#7D7D7D');
	Margin:1;
	Padding:2;
	Border-Left: 1px Transparent;  
	Border-Right: 2px Transparent;
	Border-Top: 1px Transparent;   
	Border-Bottom: 2px Transparent;
   }
.pgbar {
filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='#7CFC00', EndColorStr='#00FF00');
width:400px;
-webkit-transition: width .6s;
transition: width .6s;
}
td.Pbar {
border:2px;
border-style:solid;
border-color:#000000;
width:400px
}
</style>
<script language='vbscript'>
'-> Resize And Move Window
  Dim Wth :Wth = int(425)
  Dim Hht :Hht = int(130)
  window.ResizeTo Wth, Hht
  MoveTo ((Screen.Width / 2) - (Wth / 2)),((Screen.Height / 2) - (Hht / 2))
'-> Text Display Varible
  Dim F1 :F1 = "<FONT STYLE='Font:10.0pt;Color:#000000;Font-Weight:Bold;'>"
'-> Count Down Display Varibles
  Dim D1, D2, D3
'-> OnLoad Action
   Function Window_OnLoad()
bar.style.width = "0%"
InitC = "0"
Mode = "update"
arrCommands = Split(AppUpdateStart.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	InitC = arrCommands(1)
	Mode = arrCommands(2)
   Next
If InitC = "0" Then
idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
Exit Function
End If
If Mode = "update" Then
	txt1.innerHTML = F1 & "Procurando Atualizações...</FONT>"
ElseIf Mode = "install" Then
	txt1.innerHTML = F1 & "Obtendo Informações...</FONT>"
End If
	txt3.innerHTML = F1 & "</FONT>"
	txt2.innerHTML = F1 & "0%</FONT>"
	Counter()
   End Function
'-> Count Down Function
   Function Counter()
On Error Resume Next
	 D1 = 0
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("StatusPS.log", 1, True)
D2 = objRead2.ReadLine
If D2 = "close" Then
	Set objFSO2 = Nothing
	Set objRead2 = Nothing
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
End If
If D2 = "fail" Then
	txt1.innerHTML = Replace(F1,"000000","8B0000") & "Falha...</FONT>"
	Set objFSO2 = Nothing
	Set objRead2 = Nothing
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
End If
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBarS.log", 1, True)
D1 = objRead.ReadLine
D1 = Replace(D1," ","")
If D1 = 0 Then
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Counter", 1, "VBScript")
ElseIf D1 = 100 Then
bar.style.width = D1 & "%"
	 txt2.innerHTML = F1 & D1 & "%</FONT>"
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Counter", 1, "VBScript")
Else
bar.style.width = D1 & "%"
	 txt2.innerHTML = F1 & D1 & "%</FONT>"
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Counter", 1, "VBScript")
End If
Exit Function
erro:
idTimer = window.setTimeout("Counter", 1, "VBScript")
   End Function
'-> Close The HTA Window
   Function HtaExit() 
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
   End Function
'-> Timer2
   Function MyTimer2()
	window.close()
	window.clearTimeout(idTimer)
   Exit Function
   End Function
</script>
</head>
 <body scroll='No' onKeyDown='javascript:Verificar()'>
<!-- txt1 Display -->
<table align='Center'><td class='Type1'><span id='txt1'></span></td></table>
<!-- txt2 Display -->
<table align='Center'><td class='Type1'><span id='txt2'></span></td></table>
<table align='Center'><td class='Type1'><span id='txt3' class="txt3"></span></td></table>
<table><td class='Pbar'><span id="bar" class="pgbar"></span></td></table>
 </body>
</html>