<html>
<head>
<title>Conectando...</title>
  <HTA:APPLICATION ID="AppUpdateStart" 
   SCROLL="No"		   
   SCROLLFLAT ="No"  
   SingleInstance="Yes"   
   ShowInTaskbar="Yes"		   
   SysMenu="No"		  
   MaximizeButton="No"		
   MinimizeButton="No"	
   Border="Thin" 
   BORDERSTYLE ="complex" 
   INNERBORDER ="No"  
   Caption="Yes"		  
   WindowState="Normal" 
   APPLICATIONNAME="UpdateStart|CODE|"
   VERSION="3.0.1"
   Icon="App.exe">
<meta http-equiv="x-ua-compatible" content="ie=9"/>
<script type="text/javascript">
    Wth = parseInt(430);
    Hht = parseInt(165);
    window.resizeTo(Wth,Hht);
    window.moveTo((window.screen.availWidth/2)-(Wth/2), (window.screen.availHeight/2)-(Hht/2)+20);
</script>
<script src="functional.js"></script>
<style type="text/css">
  body
   {
	Font-Size:10.00pt;
	Font-Weight:Bold;
	Font-Family:helvetica,verdana,arial;
	Height:126px;
	Color:#000000;
	Cursor:Default;
	BackGround-Color:#FF8C00;
	Margin-Top:0px;
	Margin-Bottom:0px;
	Margin-Left:0px;
	Margin-Right:0px;
	Padding-Top:3px;
	Padding-Bottom:3px;
	Padding-Left:5px;
	Padding-Right:5px;
	Text-Align:Left;
	Vertical-Align:Top;
	-webkit-box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
	-moz-box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
	box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
   }
  td.Type1
   {
	Margin-Left:21px;
	Padding-Left:15px;
   }
  button
   { 
	Height:18pt;  
	Width:61pt;
	Cursor:Hand;
	Cursor:Pointer;
	Font:10.0pt;
	Font-weight:bold;
	Font-family:helvetica,verdana,arial;
	Color:#000000;
	Text-Align:Center;
	Vertical-Align:Middle;
	/*/filter:progid:DXImageTransform.Microsoft.Gradient(StartColorStr='#E5E5E5',EndColorStr='#7D7D7D');/*/
	border:1px;
	border-style:solid;
	border-color:#000000;
	   -webkit-border-top-right-radius: 20px;
	-webkit-border-bottom-right-radius: 20px;
	       -moz-border-radius-topright: 20px;
	    -moz-border-radius-bottomright: 20px;
	           border-top-right-radius: 20px;
	        border-bottom-right-radius: 20px;
	    -webkit-border-top-left-radius: 20px;
	 -webkit-border-bottom-left-radius: 20px;
	        -moz-border-radius-topleft: 20px;
	     -moz-border-radius-bottomleft: 20px;
	            border-top-left-radius: 20px;
	         border-bottom-left-radius: 20px;
	background-color: #E5E5E5;
	background-image: -webkit-gradient(
	  linear,
	  left bottom,
	  left top,
	  color-stop(0, rgb(43,194,83)),
	  color-stop(1, rgb(84,240,84))
	 );
	background-image: -moz-linear-gradient(
	  center bottom,
	  rgb(43,194,83) 37%,
	  rgb(84,240,84) 69%
	 );
	-webkit-box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
	-moz-box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
	box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
   }
   .bred
   {
	background-color: rgb(243,64,64);
   }
   .bgreen
   {
	background-color: rgb(43,194,83);
   }
   .pgbar
   {
	/*/filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='#7CFC00', EndColorStr='#00FF00');
	BackGround-Color:#00FF00;/*/
	width:0px;
	height:22px;
	-webkit-transition: width .6s;
	transition: width .6s;
	   -webkit-border-top-right-radius: 20px;
	-webkit-border-bottom-right-radius: 20px;
	       -moz-border-radius-topright: 20px;
	    -moz-border-radius-bottomright: 20px;
	           border-top-right-radius: 20px;
	        border-bottom-right-radius: 20px;
	    -webkit-border-top-left-radius: 20px;
	 -webkit-border-bottom-left-radius: 20px;
	        -moz-border-radius-topleft: 20px;
	     -moz-border-radius-bottomleft: 20px;
	            border-top-left-radius: 20px;
	         border-bottom-left-radius: 20px;
	background-color: rgb(43,194,83);
	background-image: -webkit-gradient(
	  linear,
	  left bottom,
	  left top,
	  color-stop(0, rgb(43,194,83)),
	  color-stop(1, rgb(84,240,84))
	 );
	background-image: -moz-linear-gradient(
	  center bottom,
	  rgb(43,194,83) 37%,
	  rgb(84,240,84) 69%
	 );
	-webkit-box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
	-moz-box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
	box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
	position: relative;
	overflow: hidden;
   }
   .Pbar
   {
	border:2px;
	border-style:solid;
	border-color:#000000;
	width:400px
	height:22px;
	position: relative;
	background: #555;
	-moz-border-radius: 25px;
	-webkit-border-radius: 25px;
	border-radius: 25px;
	-webkit-box-shadow: inset 0 -1px 1px rgba(255,255,255,0.3);
	-moz-box-shadow   : inset 0 -1px 1px rgba(255,255,255,0.3);
	box-shadow        : inset 0 -1px 1px rgba(255,255,255,0.3);
   }
   .server
   {
	border:1px;
	border-style:solid;
	border-color:#000000;
	BackGround-Color:#FFFF00;
	width:25.6px;
	height:25.6px;
	padding:2px;
	-moz-border-radius: 15px;
	-webkit-border-radius: 15px;
	border-radius: 15px;
	-webkit-box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
	-moz-box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
	box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
   }
   #serverlogo
   {
	width:25.6px;
	height:25.6px;
	-moz-border-radius: 15px;
	-webkit-border-radius: 15px;
	border-radius: 15px;
	-webkit-box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
	-moz-box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
	box-shadow: 
	  inset 0 2px 9px  rgba(255,255,255,0.3),
	  inset 0 -2px 6px rgba(0,0,0,0.4);
   }
</style>
</head>
 <body onLoad='vbscript:VB_Loader()' scroll='No' onKeyDown='javascript:Verificar()' ondragstart='return false'>
<!-- txt1 Display -->
<table align='Center' style="margin-top:5px;"><td class='Type1'><span id='txt1'>Iniciando...</span></td></table>
<!-- txt2 Display -->
<table align='Center'><td class='Type1'><span id='txt2'>0%</span></td></table>
<table align='Center'><td class='Type1'><span id='txt3' class="txt3"></span></td></table>
<div class='Pbar'><div id="bar" class="pgbar"></div></div>
<table align='Center' style="margin-top:5px;margin-right:20px;"><div class='server' id='server' style="display:none"><img id="serverlogo" title="" name="serverlogo" src="error.png"></img></div></table>
<input id="point" type="text" name="point" style="display:none" value="   " />
<input id="ITG" type="text" name="ITG" style="display:none" value="" />
<input id="IGH" type="text" name="IGH" style="display:none" value="" />
 </body>
<script>
  //DD_roundies.addRule('.server', '15px', true);
  DD_roundies.addRule('.Pbar, .pgbar', '10px', true);//
</script>
<script type="text/javascript">
//<![CDATA[
var mensagem="";
function clickIE() {if (document.all) {(mensagem);return false;}}
function clickNS(e) {if
(document.layers||(document.getElementById&&!document.all)) {
if (e.which==2||e.which==3) {(mensagem);return false;}}}
if (document.layers)
{document.captureEvents(Event.MOUSEDOWN);document.onmousedown=clickNS;}
else{document.onmouseup=clickNS;document.oncontextmenu=clickIE;}
document.oncontextmenu=new Function("return false")
//]]>
</script>
<script type="text/javascript">
function disableselect(e){return 
false;} document.onselectstart=new Function ("return false"); if (window.sidebar){document.onmousedown=disableselect; 
document.onclick=reEnable;}
</script>
<script language="JavaScript">
function Verificar(){
var tecla=window.event.keyCode;
if (tecla==116) {event.keyCode=0; event.returnValue=false;}
}
</script>
<script language='vbscript'>
On Error Resume Next
'-> Resize And Move Window
  Dim Wth :Wth = int(430)
  Dim Hht :Hht = int(165)
  window.ResizeTo Wth, Hht
  MoveTo ((Screen.Width / 2) - (Wth / 2)),((Screen.Height / 2) - (Hht / 2))
'-> Text Display Varible
  Dim F1 :F1 = "<FONT STYLE='Font:10.0pt;Color:#000000;Font-Weight:Bold;'>"
'-> Count Down Display Varibles
  Dim D1, D2, D3
'-> OnLoad Action
   Function VB_Loader()
bar.style.width = "0%"
InitC = "0"
Mode = "update"
arrCommands = Split(AppUpdateStart.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	InitC = arrCommands(1)
	Mode = arrCommands(2)
   Next
If InitC = "0" Then
idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
Exit Function
End If
If Mode = "update" Then
	txt1.innerHTML = F1 & "Procurando Atualizações</FONT>"
ElseIf Mode = "install" Then
	txt1.innerHTML = F1 & "Obtendo Informações</FONT>"
End If
	txt3.innerHTML = F1 & "</FONT>"
	txt2.innerHTML = F1 & "0%</FONT>"
	Counter()
	ImportImageData()
	PointerP()
	ServerCheck()
   End Function
   Function PointerP()
On Error Resume Next
Pt = point.value
Pit0 = "   "
Pit1 = ".  "
Pit2 = ".. "
Pit3 = "..."
If Pt = Pit1 Then
point.value = Pit2
idTimer = window.setTimeout("PointerP", 500, "VBScript")
Exit Function
ElseIf Pt = Pit2 Then
point.value = Pit3
idTimer = window.setTimeout("PointerP", 500, "VBScript")
Exit Function
ElseIf Pt = Pit3 Then
point.value = Pit0
idTimer = window.setTimeout("PointerP", 500, "VBScript")
Exit Function
ElseIf Pt = Pit0 Then
point.value = Pit1
idTimer = window.setTimeout("PointerP", 500, "VBScript")
Exit Function
End If
   Exit Function
   End Function
   Function ImportImageData()
On Error Resume Next
Set oShell = CreateObject("WScript.Shell")
Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")
Set colOperatingSystems = objWMIService.ExecQuery("Select * from Win32_OperatingSystem")
For Each objOperatingSystem in colOperatingSystems
	OSversion = replace(objOperatingSystem.Version,".","")
Next

Set objFSOI = CreateObject("Scripting.FileSystemObject")
Set objReadI = objFSOI.OpenTextFile("ImageData.tgib64", 1, False)
DImage = objReadI.ReadAll
DImagec = Split(DImage, "-!.!-")
   For i = 1 to (Ubound(DImagec))
	ImageTG = DImagec(1)
	ImageGH = DImagec(2)
   Next
ImageDr = Split(ImageTG, "+-!-+")
   For i = 1 to (Ubound(ImageDr))
	ImageIDTG = ImageDr(0)
	ImageTG = ImageDr(1)
   Next
ImageDr = Split(ImageGH, "+-!-+")
   For i = 1 to (Ubound(ImageDr))
	ImageIDGH = ImageDr(0)
	ImageGH = ImageDr(1)
   Next

If OSversion < 520000 Then
serverlogo.title = "O Windows XP é imcompatível com imagens Base64!"
ErrorImage = "error.png"
ITG.value = ErrorImage
IGH.value = ErrorImage
Exit Function
Else
ErrorImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABMlBMVEVHcEwAAAAAAAACAgIAAAAFBQUAAAAdGxsAAAAAAAB9Hx4AAAAAAAAAAADDe3oZCQmbe3sAAABaFxYyDg0AAAAAAACqa2uRfn7Pk5OZJSNdGxrYkpEAAACoJSJIExNKHx4cCAitMzGFIyK7dHNZGBgMBQV7IiBqHx3ScW6uPjvYnZylcnKvaGjDgoKnZ2YAAAAEAgFsGxvDgH/Uqqm1eHfJe3iIUE+GMzGrQUA6GBcLAwNkGxubS0qtZGLiop+yammdIyJaGhlSHx4AAACNIiDaJR3riITvnZnDJiLRJR7tk4/ndG/IJSC9JiPwpqPpf3rMJR/ysa7UJR3dLibefnrcYVzst7bXJR30ure0JiTSTkraU064JyXwsa7nbmjfPjfqfnnlZV/dPjfFLyvMNTDRSURS8PFPAAAAVXRSTlMAJQY0LRMZAQx772E+XtEgJYzYvXBXhA/S72DpSfrMRav01ZLer7CH/vT0UKpzqIaZ5dVN1fTBxspYnMKLruXg9rdTKO7////////////////////+Vb828gAAATVJREFUeNp1k9dWwkAURWOKJDEJHRFEpNl77+hyzSRDegQRsJf//wWHN3045/XsO7Nm3zXC/xxaB6WMmBJQdh6f4pcjSUX9Nu+DwD6RRQCU4ziw7d6xOQuADT7e69G+dg+AKh+nNOxnZQBYfDx8/2hAYIuPu29Eh1eUwvD1gZBcIQ2Azb7Le7I0h16RWZv2Sb6oAGB+nfBEy4tIZWphCjh7hoiAJiHDYS0rwW2tsCRh+q4soKx6jLF9bQYCFYexCGrgqfuR50ENPOmR5zlYAxdRcxwfa5iK8P3RhSFioHKZy2tySoBRDNM0FAxkWjfV67qKgbJtU7d7Do9o2ZS6g8Ep/BgWdd3BeNyAps4+J5Of769buIyriIv0n9sQUJoO7/UOvEKU73S93Sng36vKRU0zpb8ifgHeGzVHydMjiQAAAABJRU5ErkJggg=="
End If

If ImageTG = "" Then
ITG.value = ErrorImage
Else
ITG.value = ImageTG
End If

If ImageGH = "" Then
IGH.value = ErrorImage
Else
IGH.value = ImageGH
End If
   Exit Function
   End Function
   Function ServerCheck()
On Error Resume Next
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ServerS.log", 1, False)
D1 = objRead.ReadLine
D1c = Split(D1, "-")
   For i = 1 to (Ubound(D1c))
	D1 = D1c(0)
	D2 = D1c(1)
   Next
D1 = Replace(D1," ","")
D2 = Replace(D2," ","")

ImageTG = ITG.value
ImageGH = IGH.value

If D1 = 1 Then
server.style.display = "block"
serverlogo.title = "Conectando com: Servidor Traduções de Jogos"
serverlogo.src= ImageTG
ElseIf D1 = 2 Then
server.style.display = "block"
serverlogo.title = "Conectando com: Servidor GitHub"
serverlogo.src= ImageGH
Else
server.style.display = "none"
serverlogo.title = "Conectando com: Servidor Traduções de Jogos"
serverlogo.src= ImageTG
End If

If D2 = 1 Then
server.style.backgroundcolor = "#FFFF00"
ElseIf D2 = 2 Then
server.style.backgroundcolor = "#00FF00"
End If

idTimer = window.setTimeout("ServerCheck", 1, "VBScript")
   Exit Function
   End Function
'-> Count Down Function
   Function Counter()
On Error Resume Next
	 D1 = 0
Mode = "update"
Pt = point.value
arrCommands = Split(AppUpdateStart.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Mode = arrCommands(2)
   Next
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("StatusPS.log", 1, False)
D2 = objRead2.ReadLine
If D2 = "close" Then
	Set objFSO2 = Nothing
	Set objRead2 = Nothing
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
End If
If D2 = "fail" Then
	txt1.innerHTML = Replace(F1,"000000","8B0000") & "Falha...</FONT>"
	Set objFSO2 = Nothing
	Set objRead2 = Nothing
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
End If
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBarS.log", 1, False)
D1 = objRead.ReadLine
D1 = Replace(D1," ","")
If D1 = 0 Then
If Mode = "update" Then
	txt1.innerHTML = F1 & "Procurando Atualizações"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	txt1.innerHTML = F1 & "Obtendo Informações"& Pt &"</FONT>"
End If
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Counter", 1, "VBScript")
ElseIf D1 = 100 Then
bar.style.width = D1 & "%"
If Mode = "update" Then
	txt1.innerHTML = F1 & "Procurando Atualizações"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	txt1.innerHTML = F1 & "Obtendo Informações"& Pt &"</FONT>"
End If
	 txt2.innerHTML = F1 & D1 & "%</FONT>"
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Counter", 1, "VBScript")
Else
bar.style.width = D1 & "%"
If Mode = "update" Then
	txt1.innerHTML = F1 & "Procurando Atualizações"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	txt1.innerHTML = F1 & "Obtendo Informações"& Pt &"</FONT>"
End If
	 txt2.innerHTML = F1 & D1 & "%</FONT>"
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Counter", 1, "VBScript")
End If
Exit Function
erro:
idTimer = window.setTimeout("Counter", 1, "VBScript")
   End Function
'-> Close The HTA Window
   Function HtaExit() 
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
   End Function
'-> Timer2
   Function MyTimer2()
	window.close()
	window.clearTimeout(idTimer)
   Exit Function
   End Function
</script>
</html>