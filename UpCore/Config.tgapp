<html>
<head>
<title>Configurações do Atualizador</title>
  <HTA:APPLICATION ID="AppConfigUp" 
   SCROLL="No"		   
   SCROLLFLAT="No"  
   SingleInstance="Yes"   
   ShowInTaskbar="Yes"		   
   SysMenu="Yes"		  
   MaximizeButton="No"		
   MinimizeButton="Yes"	
   Border="Thin" 
   BORDERSTYLE="complex" 
   INNERBORDER="No"  
   Caption="Yes"		  
   WindowState="Normal" 
   APPLICATIONNAME="ConfigUp|CODE|"
   VERSION="2.4"
   Icon="App.exe">
<meta http-equiv="x-ua-compatible" content="ie=6"/>
<script type="text/javascript">
    Wth = parseInt(425);
    Hht = parseInt(360);
    window.resizeTo(Wth,Hht);
    window.moveTo((window.screen.availWidth/2)-(Wth/2), (window.screen.availHeight/2)-(Hht/2)+20);
</script>
<script type="text/javascript">
//<![CDATA[
var mensagem="";
function clickIE() {if (document.all) {(mensagem);return false;}}
function clickNS(e) {if
(document.layers||(document.getElementById&&!document.all)) {
if (e.which==2||e.which==3) {(mensagem);return false;}}}
if (document.layers)
{document.captureEvents(Event.MOUSEDOWN);document.onmousedown=clickNS;}
else{document.onmouseup=clickNS;document.oncontextmenu=clickIE;}
document.oncontextmenu=new Function("return false")
//]]>
</script>
<script type="text/javascript">
function disableselect(e){return 
false;} document.onselectstart=new Function ("return false"); if (window.sidebar){document.onmousedown=disableselect; 
document.onclick=reEnable;}
</script>
<script language="JavaScript">
function Verificar(){
var tecla=window.event.keyCode;
if (tecla==116) {event.keyCode=0; event.returnValue=false;}
}
</script>
<style type="text/css">
  body
   {
	Font-Size:11.25pt;
	Font-Weight:Bold;
	Font-Family:helvetica,verdana,arial;
	Color:#000000;
	Cursor:Default;
	BackGround-Color:#FF8C00;
	Margin-Top:5px;
	Margin-Bottom:5px;
	Margin-Left:5px;
	Margin-Right:5px;
	Padding-Top:3px;
	Padding-Bottom:3px;
	Padding-Left:5px;
	Padding-Right:5px;
	Text-Align:Left;
	Vertical-Align:Top;
   }
  .opt
   {
	Cursor:Hand;
   }
  td.Type1
   {
    Margin-Left:21px;
    Padding-Left:15px;
   }
  button
   { 
	Height:18pt;  
	width:61pt;
	Cursor:Hand;
	Font:10.0pt;
	Font-weight:bold;
	Font-family:helvetica,verdana,arial;
	Color:#000000;
	Text-Align:Center;
	Vertical-Align:Middle;
	filter:progid:DXImageTransform.Microsoft.Gradient(StartColorStr='#E5E5E5',EndColorStr='#7D7D7D');
	Margin:1px;
	Padding:2px;
	Border-Left: 1px Transparent;  
	Border-Right: 2px Transparent;
	Border-Top: 1px Transparent;   
	Border-Bottom: 2px Transparent;
   }
</style>
<script language='vbscript'>
'-> Resize And Move Window
  Dim Wth :Wth = int(425)
  Dim Hht :Hht = int(360)
  window.ResizeTo Wth, Hht
  MoveTo ((Screen.Width / 2) - (Wth / 2)),((Screen.Height / 2) - (Hht / 2))
'-> Text Display Varible
  Dim F1, F2 :F1 = "<FONT STYLE='Font:10.0pt;Color:#000000;Font-Weight:Bold;'>" :F2 = "<FONT STYLE='Font:8.0pt'>"
'-> OnLoad Action
   Function Window_OnLoad()
Code = "0"
	txt1.innerHTML = F1 & "Carregando...</FONT>"
arrCommands = Split(AppConfigUp.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Code = arrCommands(1)
   Next
If Code = "0" Then
idTimer = window.setTimeout("CloseW", 1, "VBScript")
Exit Function
End If
	Init()
	PointerP()
   End Function
   Function PointerP()
On Error Resume Next
Pt = point.value
Pit0 = ""
Pit1 = "."
Pit2 = ".."
Pit3 = "..."
If Pt = Pit1 Then
bsaving.innerHTML = "Salvando"& Pt
point.value = Pit2
idTimer = window.setTimeout("PointerP", 100, "VBScript")
Exit Function
ElseIf Pt = Pit2 Then
bsaving.innerHTML = "Salvando"& Pt
point.value = Pit3
idTimer = window.setTimeout("PointerP", 100, "VBScript")
Exit Function
ElseIf Pt = Pit3 Then
bsaving.innerHTML = "Salvando"& Pt
point.value = Pit0
idTimer = window.setTimeout("PointerP", 100, "VBScript")
Exit Function
ElseIf Pt = Pit0 Then
bsaving.innerHTML = "Salvando"& Pt
point.value = Pit1
idTimer = window.setTimeout("PointerP", 100, "VBScript")
Exit Function
End If
   Exit Function
   End Function
'-> Count Down Function
   Function Init()
On Error Resume Next
Code = "0"
translationof = "0"
soc.value = "compatible"
AutoED.value = "enabled"
arrCommands = Split(AppConfigUp.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Code = arrCommands(1)
   Next
Set oShell = CreateObject("WScript.Shell")
Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")
Set colOperatingSystems = objWMIService.ExecQuery("Select * from Win32_OperatingSystem")
For Each objOperatingSystem in colOperatingSystems
	OSversion = replace(objOperatingSystem.Version,".","")
Next
If Code = "0" Then
cod.value = "0"
idTimer = window.setTimeout("CloseW", 1, "VBScript")
Exit Function
Else
cod.value = Code
End If
If code = "350" Then
config = oShell.RegRead("HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\TranslateGames(350-1)\UpConfig")
Else
config = oShell.RegRead("HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\TranslateGames("& code &")\UpConfig")
End If
If (config) Then
config = Split(config, "|.|")
   For i = 1 to (Ubound(config))
	AutoOp = config(0)
	TimeOp = config(1)
	LimitOp = config(2)
   Next
Else
msgbox"Falha na Configuração!"
idTimer = window.setTimeout("CloseW", 1, "VBScript")
Exit Function
End If
If Code = "350" Then
translationof = "Dawn of War e Winter Assault"
ElseIf Code = "350-3" Then
translationof = "Dawn of War - Dark Crusade"
ElseIf Code = "350-4" Then
translationof = "Dawn of War - Soulstorm"
ElseIf Code = "356" Then
translationof = "Age of Mythology"
ElseIf Code = "356-2" Then
translationof = "Age of Mythology: The Titans Expansion"
ElseIf Code = "357" Then
translationof = "Dawn of War II - Retribution"
ElseIf Code = "358" Then
translationof = "Dawn of War II e Chaos Rising"
End If
If translationof = "0" Then
Else
txt3.innerHTML = F2 & translationof & "</FONT>"
End If
If AutoOp = "Ativar" Then
AutoUp(0).Checked=true
ElseIf AutoOp = "Desativar" Then
AutoUp(1).Checked=true
TimerA(0).Disabled=true
TimerA(1).Disabled=true
TimerA(2).Disabled=true
TimerA(3).Disabled=true
OptT1.style.color = "#808080"
OptT2.style.color = "#808080"
OptT3.style.color = "#808080"
OptT4.style.color = "#808080"
AutoED.value = "disabled"
End If
If TimeOp = "10800" Then
TimerA(0).Checked=true
ElseIf TimeOp = "14400" Then
TimerA(1).Checked=true
ElseIf TimeOp = "18000" Then
TimerA(2).Checked=true
ElseIf TimeOp = "21600" Then
TimerA(3).Checked=true
End If
If LimitOp = "0" Then
LimitOp = "Ilimitado"
End If
If LimitOp = "Ilimitado" Then
Limit(0).Selected=true
ElseIf LimitOp = "50k" Then
Limit(1).Selected=true
ElseIf LimitOp = "100k" Then
Limit(2).Selected=true
ElseIf LimitOp = "300k" Then
Limit(3).Selected=true
ElseIf LimitOp = "500k" Then
Limit(4).Selected=true
ElseIf LimitOp = "1m" Then
Limit(5).Selected=true
ElseIf LimitOp = "2m" Then
Limit(6).Selected=true
ElseIf LimitOp = "5m" Then
Limit(7).Selected=true
End If
If OSversion < 500000 Then
AutoUp(0).Disabled=true
AutoUp(1).Checked=true
TimerA(0).Disabled=true
TimerA(1).Disabled=true
TimerA(2).Disabled=true
TimerA(3).Disabled=true
OptA1.style.color = "#808080"
OptT1.style.color = "#808080"
OptT2.style.color = "#808080"
OptT3.style.color = "#808080"
OptT4.style.color = "#808080"
soc.value = "incompatible"
AutoED.value = "disabled"
txt2.innerHTML = F1 & "(S.O. Incompatível)</FONT>"
End If
txt1.innerHTML = F1 & "Configurações do Atualizador</FONT>"
   End Function

   Function Save()
On Error Resume Next
bsave.style.display = "none"
bsaving.style.display = "block"
AutoOp = "0"
TimeOp = "0"
Code = cod.value
If AutoUp(0).Checked Then
AutoOp = AutoUp(0).Value
ElseIf AutoUp(1).Checked Then
AutoOp = AutoUp(1).Value
End If
If TimerA(0).Checked Then
TimeOp = TimerA(0).Value
ElseIf TimerA(1).Checked Then
TimeOp = TimerA(1).Value
ElseIf TimerA(2).Checked Then
TimeOp = TimerA(2).Value
ElseIf TimerA(3).Checked Then
TimeOp = TimerA(3).Value
End If
LimitOp = Limit.value
If AutoOp = "0" Then
bsaving.style.display = "none"
bsaveerror.style.display = "block"
msgbox"Selecione uma das opções de ativação!",vbCritical,"Erro"
bsaveerror.style.display = "none"
bsave.style.display = "block"
Exit Function
End If
If TimeOp = "0" Then
bsaving.style.display = "none"
bsaveerror.style.display = "block"
msgbox"Selecione uma das opções de tempo de verificação!",vbCritical,"Erro"
bsaveerror.style.display = "none"
bsave.style.display = "block"
Exit Function
End If
If Code = "0" Then
bsaving.style.display = "none"
bsaveerror.style.display = "block"
msgbox"O Código da Tradução é necessário!",vbCritical,"Erro"
bsaveerror.style.display = "none"
bsave.style.display = "block"
Exit Function
End If
Set oShell = CreateObject("WScript.Shell")
Result = AutoOp &"|.|"& TimeOp &"|.|"& LimitOp
If code = "350" Then
oShell.RegWrite "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\TranslateGames(350-1)\UpConfig", Result, "REG_SZ"
Else
oShell.RegWrite "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\TranslateGames("& code &")\UpConfig", Result, "REG_SZ"
End If
If code = "350" Then
config = oShell.RegRead("HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\TranslateGames(350-1)\UpConfig")
Else
config = oShell.RegRead("HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\TranslateGames("& code &")\UpConfig")
End If
If config = result Then
bsaving.style.display = "none"
bsaved.style.display = "block"
msgbox"Configurações Salvas!",vbInformation,"Salvo!"
bsaved.style.display = "none"
bsave.style.display = "block"
Exit Function
Else
bsaving.style.display = "none"
bsaveerror.style.display = "block"
msgbox"Falha ao Salvar Configuração!",vbCritical,"Erro"
bsaveerror.style.display = "none"
bsave.style.display = "block"
Exit Function
End If
Exit Function
   End Function
   Function SelectA(D1)
socOpt = soc.value
autoedOpt = AutoED.value
If D1 = "Ativar" Then
If socOpt = "compatible" Then
AutoUp(0).Checked=true
OptT1.style.color = "#000000"
OptT2.style.color = "#000000"
OptT3.style.color = "#000000"
OptT4.style.color = "#000000"
TimerA(0).Disabled=false
TimerA(1).Disabled=false
TimerA(2).Disabled=false
TimerA(3).Disabled=false
AutoED.value = "enabled"
End If
ElseIf D1 = "Desativar" Then
AutoUp(1).Checked=true
OptT1.style.color = "#808080"
OptT2.style.color = "#808080"
OptT3.style.color = "#808080"
OptT4.style.color = "#808080"
TimerA(0).Disabled=true
TimerA(1).Disabled=true
TimerA(2).Disabled=true
TimerA(3).Disabled=true
AutoED.value = "disabled"
End If
If D1 = "10800" Then
If autoedOpt = "enabled" Then
TimerA(0).Checked=true
End If
ElseIf D1 = "14400" Then
If autoedOpt = "enabled" Then
TimerA(1).Checked=true
End If
ElseIf D1 = "18000" Then
If autoedOpt = "enabled" Then
TimerA(2).Checked=true
End If
ElseIf D1 = "21600" Then
If autoedOpt = "enabled" Then
TimerA(3).Checked=true
End If
End If
Exit Function
   End Function
'-> Close App Command
   Function HtaExit() 
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("CloseW", 1, "VBScript")
   End Function
'-> Close
   Function CloseW()
	window.close()
	window.clearTimeout(idTimer)
   Exit Function
   End Function
</script>
</head>
 <body scroll='No' onKeyDown='javascript:Verificar()' ondragstart='return false'>
<!-- txt1 Display -->
<table align='Center'><td class='Type1'><span id='txt1'></span></td></table>
<!-- Display -->
Atualização Automática:<br/>
<input class='opt' type="radio" name="AutoUp" onclick='SelectA("Ativar")' value="Ativar" /><span class='opt' id='optA1' onclick='SelectA("Ativar")'>Ativar a Atualização Automática.</span><span id='txt2'></span><br/>
<input class='opt' type="radio" name="AutoUp" onclick='SelectA("Desativar")' value="Desativar" /><span class='opt' id='optA2' onclick='SelectA("Desativar")'>Desativar a Atualização Automática.</span><br/><br/>
Tempo de Verificação:<br/>
<input class='opt' type="radio" name="TimerA" value="10800" /><span class='opt' id='optT1' onclick='SelectA("10800")'>A Cada 3 Horas.</span><br/>
<input class='opt' type="radio" name="TimerA" value="14400" /><span class='opt' id='optT2' onclick='SelectA("14400")'>A Cada 4 Horas.</span><br/>
<input class='opt' type="radio" name="TimerA" value="18000" /><span class='opt' id='optT3' onclick='SelectA("18000")'>A Cada 5 Horas.</span><br/>
<input class='opt' type="radio" name="TimerA" value="21600" /><span class='opt' id='optT4' onclick='SelectA("21600")'>A Cada 6 Horas.</span><br/><br/>
Limite de Velocidade:<br/>
<select name="Limit" id="Limit">
<option value="Ilimitado">Ilimitado</option>
<option value="50k">50 KB/s</option>
<option value="100k">100 KB/s</option>
<option value="300k">300 KB/s</option>
<option value="500k">500 KB/s</option>
<option value="1m">1 MB/s</option>
<option value="2m">2 MB/s</option>
<option value="5m">5 MB/s</option>
</select><br/><br/>
<input id="point" type="text" name="point" style="display:none" value="" />
<input id="cod" type="text" name="cod" style="display:none" value="" />
<input id="soc" type="text" name="soc" style="display:none" value="" />
<input id="AutoED" type="text" name="AutoED" style="display:none" value="" />
<table style='Margin-Top:7pt;Margin-Right:10pt;' align='Right'>
<td><button id='bsave' onclick='Save()'>Salvar</button>
<button id='bsaving' name='bsaving' style="display:none">Salvando...</button>
<button id='bsaved' style="display:none">Salvo</button>
<button id='bsaveerror' style="display:none">Erro</button></td>
</table>
<td class='Type1'><span style='font:8.0pt'>Essa configuração se aplica somente ao atualizador da Tradução de </span></td><span id='txt3'></span>
 </body>
</html>