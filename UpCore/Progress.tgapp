<html>
<head>
<title>Atualizador da Tradução</title>
  <HTA:APPLICATION ID="AppProgressUp" 
   SCROLL="No"		   
   SCROLLFLAT ="No"  
   SingleInstance="Yes"   
   ShowInTaskbar="Yes"		   
   SysMenu="No"		  
   MaximizeButton="No"		
   MinimizeButton="No"	
   Border="Thin" 
   BORDERSTYLE ="complex" 
   INNERBORDER ="No"  
   Caption="Yes"		  
   WindowState="Normal" 
   APPLICATIONNAME="ProgressUp|CODE|"
   VERSION="4.9"
   Icon="App.exe">
<meta http-equiv="x-ua-compatible" content="ie=6"/>
<script type="text/javascript">
    Wth = parseInt(430);
    Hht = parseInt(190);
    window.resizeTo(Wth,Hht);
    window.moveTo((window.screen.availWidth/2)-(Wth/2), (window.screen.availHeight/2)-(Hht/2)+20);
</script>
<script src="functional.js"></script>
<script>
  DD_roundies.addRule('.server', '15px', true);
  DD_roundies.addRule('.Pbar, .pgbar', '10px', true);
</script>
<script type="text/javascript">
//<![CDATA[
var mensagem="";
function clickIE() {if (document.all) {(mensagem);return false;}}
function clickNS(e) {if
(document.layers||(document.getElementById&&!document.all)) {
if (e.which==2||e.which==3) {(mensagem);return false;}}}
if (document.layers)
{document.captureEvents(Event.MOUSEDOWN);document.onmousedown=clickNS;}
else{document.onmouseup=clickNS;document.oncontextmenu=clickIE;}
document.oncontextmenu=new Function("return false")
//]]>
</script>
<script type="text/javascript">
function disableselect(e){return 
false;} document.onselectstart=new Function ("return false"); if (window.sidebar){document.onmousedown=disableselect; 
document.onclick=reEnable;}
</script>
<script language="JavaScript">
function Verificar(){
var tecla=window.event.keyCode;
if (tecla==116) {event.keyCode=0; event.returnValue=false;}
}
</script>
<style type="text/css">
  body
   {
	Font-Size:12.25pt;
	Font-Weight:Bold;
	Font-Family:helvetica,verdana,arial;
	Color:#000000;
	Cursor:Default;
	BackGround-Color:#FF8C00;
	Margin-Top:5;
	Margin-Bottom:5;
	Margin-Left:5;
	Margin-Right:5;
	Padding-Top:3;
	Padding-Bottom:3;
	Padding-Left:5;
	Padding-Right:5;
	Text-Align:Left;
	Vertical-Align:Top;
   }
  td.Type1
   {
	Margin-Left:21;
	Padding-Left:15;
   }
  button
   { 
	Height:18pt;  
	width:61pt;
	Cursor:Hand;
	Font:10.0pt;
	Font-weight:bold;
	Font-family:helvetica,verdana,arial;
	Color:#000000;
	Text-Align:Center;
	Vertical-Align:Middle;
	filter:progid:DXImageTransform.Microsoft.Gradient(StartColorStr='#E5E5E5',EndColorStr='#7D7D7D');
	Margin:1;
	Padding:2;
	Border-Left: 1px Transparent;  
	Border-Right: 2px Transparent;
	Border-Top: 1px Transparent;   
	Border-Bottom: 2px Transparent;
   }
   .pgbar
   {
	/*/filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='#7CFC00', EndColorStr='#00FF00');/*/
	BackGround-Color:#00FF00;
	width:400px;
	-webkit-transition: width .6s;
	transition: width .6s;
   }
   .Pbar
   {
	border:2px;
	border-style:solid;
	border-color:#000000;
	width:400px
   }
   .server
   {
	border:2px;
	border-style:solid;
	border-color:#FFFF00;
	BackGround-Color:#FFFF00;
	width:25.6px;
	height:25.6px;
   }
   #serverlogo
   {
	width:25.6px;
	height:25.6px;
   }
</style>
<script language='vbscript'>
'-> Resize And Move Window
  Dim Wth :Wth = int(430)
  Dim Hht :Hht = int(190)
  window.ResizeTo Wth, Hht
  MoveTo ((Screen.Width / 2) - (Wth / 2)),((Screen.Height / 2) - (Hht / 2))
'-> Text Display Varible
  Dim F1 :F1 = "<FONT STYLE='Font:10.0pt;Color:#000000;Font-Weight:Bold;'>"
'-> Count Down Display Varibles
  Dim D1, D2, D3
'-> OnLoad Action
   Function Window_OnLoad()
bar.style.width = "0%"
InitC = "0"
arrCommands = Split(AppProgressUp.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	InitC = arrCommands(1)
   Next
If InitC = "0" Then
idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
Exit Function
End If
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("Status.log", 2, True)
objRead.WriteLine "0"
	Set objFSO = Nothing
	Set objRead = Nothing
	txt1.innerHTML = F1 & "Iniciando Download...</FONT>"
	txt3.innerHTML = F1 & "</FONT>"
	txt4.innerHTML = F1 & "</FONT>"
	txt2.innerHTML = F1 & "</FONT>"
	Counter()
	CheckSPD(0)
	PointerP()
	PMonitor()
	ServerCheck()
   End Function
   Function ServerCheck()
On Error Resume Next
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ServerP.log", 1, True)
D1 = objRead.ReadLine
D1s = Replace(D1," ","")
D2s = DSP.value
D3s = PSP.value

Set objFSOI = CreateObject("Scripting.FileSystemObject")
Set objReadI = objFSOI.OpenTextFile("ImageData.tgib64", 1, True)
DImage = objReadI.ReadAll
DImagec = Split(DImage, "-!.!-")
   For i = 1 to (Ubound(DImagec))
	ImageTG = DImagec(1)
	ImageDB = DImagec(2)
   Next

If D3s = "download" Then

Else

server.style.display = "none"
serverlogo.src= ImageTG
server.style.bordercolor = "#FFFF00"
server.style.backgroundcolor = "#FFFF00"
idTimer = window.setTimeout("ServerCheck", 1, "VBScript")
Exit Function

End If

If D1s = 1 Then
server.style.display = "block"
serverlogo.src= ImageTG
ElseIf D1s = 2 Then
server.style.display = "block"
serverlogo.src= ImageDB
Else
server.style.display = "none"
serverlogo.src= ImageTG
End If

If D2s = 1 Then
server.style.bordercolor = "#FFFF00"
server.style.backgroundcolor = "#FFFF00"
ElseIf D2s = 2 Then
server.style.bordercolor = "#00FF00"
server.style.backgroundcolor = "#00FF00"
End If

idTimer = window.setTimeout("ServerCheck", 1, "VBScript")
   Exit Function
   End Function
   Function PMonitor()
On Error Resume Next
Pt = point.value
Data = txt3.innerHTML
Datac = Split(Data, ">")
   For i = 1 to (Ubound(Datac))
	Data1 = Datac(0)
	Data2 = Datac(1)
   Next
Datac = Split(Data2, "<")
   For i = 1 to (Ubound(Datac))
	DataT = Datac(0)
   Next
If DataT = "" Then

Else
Data2 = Replace(Data2,"...","")
Data2 = Replace(Data2,"..","")
Data2 = Replace(Data2,".","")
Data2 = Replace(Data2,"</FONT",Pt&"</FONT>")
Data = Data1 &">"& Data2
txt3.innerHTML = Data
End If
idTimer = window.setTimeout("PMonitor", 1, "VBScript")
   Exit Function
   End Function
   Function PointerP()
On Error Resume Next
Pt = point.value
Pit0 = ""
Pit1 = "."
Pit2 = ".."
Pit3 = "..."
If Pt = Pit1 Then
point.value = Pit2
idTimer = window.setTimeout("PointerP", 500, "VBScript")
Exit Function
ElseIf Pt = Pit2 Then
point.value = Pit3
idTimer = window.setTimeout("PointerP", 500, "VBScript")
Exit Function
ElseIf Pt = Pit3 Then
point.value = Pit0
idTimer = window.setTimeout("PointerP", 500, "VBScript")
Exit Function
ElseIf Pt = Pit0 Then
point.value = Pit1
idTimer = window.setTimeout("PointerP", 500, "VBScript")
Exit Function
End If
   Exit Function
   End Function
   Function CheckSPD(D1)
On Error Resume Next
	D6 = 0
	D7 = 0
	DN = Chr(48)
arrCommands = Split(AppProgressUp.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	File = arrCommands(2)
	Total = arrCommands(3)
   Next
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.GetFile(File)
D3 = objFile.SIZE
D7 = D3
If D3 > 0 Then
D3 = Replace(D3,0,DN)
D6 = D3-D1
D8 = D3-D1
If D8 = 0 Then
DSP.value = 1
ElseIf D8 < 0 Then
DSP.value = 1
ElseIf D8 > 0 Then
DSP.value = 2
End If
If D8 < 0 Then
SPD.value = ""
ElseIf D8 = 0 Then
SPD.value = ""
ElseIf D8 < 1024 Then
SPD.value = " - "& D8 &" B/s"
ElseIf D8 > 1023999 Then
D6 = D6/1024/1024
D6c = Split(D6, ",")
   For i = 1 to (Ubound(D6c))
	D6 = D6c(0)
	D6v = D6c(1)
   Next
D6v = Replace(D6v,0,DN)
D6v = left(D6v,2)
D6 = Replace(D6,0,DN)
If D6v = 0 Then
D6v = DN&DN
ElseIf D6v > 0 Then
D6v = Replace(D6v,0,DN)
D6v = D6v&DN&DN
D6v = left(D6v,2)
Else
D6v = DN&DN
End If
If D6v = 0 Then
D6 = D6
Else
D6 = D6 &","& D6v
End If
SPD.value = " - "& D6 &" MB/s"
ElseIf D8 < 1024000 Then
D6 = D6/1024
D6c = Split(D6, ",")
   For i = 1 to (Ubound(D6c))
	D6 = D6c(0)
	D6v = D6c(1)
   Next
D6 = Replace(D6,0,DN)
SPD.value = " - "& D6 &" KB/s"
End If
End If
Rest = Total-D7
Restc = Split(Rest, ",")
   For i = 1 to (Ubound(Restc))
	Rest = Restc(0)
	Restv = Restc(1)
   Next
Seg = Rest/D8
Segc = Split(Seg, ",")
   For i = 1 to (Ubound(Segc))
	Seg = Segc(0)
	Segv = Segc(1)
   Next
If Seg = 0 Then
RPD.value = ""
ElseIf Seg > 3599 Then
SegH = Seg/60/60
SegHc = Split(SegH, ",")
   For i = 1 to (Ubound(SegHc))
	SegH = SegHc(0)
	SegHv = SegHc(1)
   Next
SegM = SegH*60*60
SegM = Seg-SegM
SegM = SegM/60
SegMc = Split(SegM, ",")
   For i = 1 to (Ubound(SegMc))
	SegM = SegMc(0)
	SegMv = SegMc(1)
   Next
SegS = SegM*60
SegS = Seg+SegS
SegS = SegS-Seg
If SegS = 0 Then
RPD.value = " "& SegH &"h "& SegM &"m restantes"
ElseIf SegM = 0 Then
RPD.value = " "& SegH &"h "& SegS &"s restantes"
Else
RPD.value = " "& SegH &"h "& SegM &"m "& SegS &"s restantes"
End If
ElseIf Seg > 59 Then
SegM = Seg/60
SegMc = Split(SegM, ",")
   For i = 1 to (Ubound(SegMc))
	SegM = SegMc(0)
	SegMv = SegMc(1)
   Next
SegS = SegM*60
SegS = Seg-SegS
If SegS = 0 Then
RPD.value = " "& SegM &"m restantes"
Else
RPD.value = " "& SegM &"m "& SegS &"s restantes"
End If
Else
RPD.value = " "& Seg &"s restantes"
End If
idTimer = window.setTimeout("CheckSPD("""&D7&""")", 1000, "VBScript")
Exit Function
   End Function
'-> Count Down Function
   Function Counter()
On Error Resume Next
	 D1 = 0
	 D4 = 0
	 D5 = 0
	 DN = Chr(48)
Mode = "update"
arrCommands = Split(AppProgressUp.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	File = arrCommands(2)
	Total = arrCommands(3)
	Mode = arrCommands(4)
   Next
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.GetFile(File)
ASize = objFile.SIZE

TotalSize = Total/100
Percent = ASize/TotalSize
Tam = ASize
Tam2 = Tam
Tam3 = Tam/1024
Tam3c = Split(Tam3, ",")
   For i = 1 to (Ubound(Tam3c))
	Tam3 = Tam3c(0)
	Tam3v = Tam3c(1)
   Next
Tam3v = Replace(Tam3v,0,DN)
Tam3v = left(Tam3v,2)
Tam3 = Replace(Tam3,0,DN)
If Tam3v = 0 Then
Tam3v = DN&DN
ElseIf Tam3v > 0 Then
Tam3v = Replace(Tam3v,0,DN)
Tam3v = Tam3v&DN&DN
Tam3v = left(Tam3v,2)
Else
Tam3v = DN&DN
End If
Tam3 = Tam3 &","& Tam3v
Tam = Tam3 &" KB"
If Tam2 < 1024 Then
Tam = ASize &" B"
ElseIf Tam2 > 1023999 Then
Tam = Tam2/1024/1024
Tamc = Split(Tam, ",")
   For i = 1 to (Ubound(Tamc))
	Tam = Tamc(0)
	Tamv = Tamc(1)
   Next
Tamv = Replace(Tamv,0,DN)
Tamv = left(Tamv,2)
Tam = Replace(Tam,0,DN)
If Tamv = 0 Then
Tamv = DN&DN
ElseIf Tamv > 0 Then
Tamv = Replace(Tamv,0,DN)
Tamv = Tamv&DN&DN
Tamv = left(Tamv,2)
Else
Tamv = DN&DN
End If
Tam = Tam &","& Tamv &" MB"
End If
Tot = Total
Tot2 = Tot
Tot3 = Tot/1024
Tot3c = Split(Tot3, ",")
   For i = 1 to (Ubound(Tot3c))
	Tot3 = Tot3c(0)
	Tot3v = Tot3c(1)
   Next
Tot3v = Replace(Tot3v,0,DN)
Tot3v = left(Tot3v,2)
Tot3 = Replace(Tot3,0,DN)
If Tot3v = 0 Then
Tot3v = DN&DN
ElseIf Tot3v > 0 Then
Tot3v = Replace(Tot3v,0,DN)
Tot3v = Tot3v&DN&DN
Tot3v = left(Tot3v,2)
Else
Tot3v = DN&DN
End If
Tot3 = Tot3 &","& Tot3v
Tot = Tot3 &" KB"
If Tot2 < 1024 Then
Tam = Total &" B"
ElseIf Tot2 > 1023999 Then
Tot = Tot2/1024/1024
Totc = Split(Tot, ",")
   For i = 1 to (Ubound(Totc))
	Tot = Totc(0)
	Totv = Totc(1)
   Next
Totv = Replace(Totv,0,DN)
Totv = left(Totv,2)
Tot = Replace(Tot,0,DN)
If Totv = 0 Then
Totv = DN&DN
ElseIf Totv > 0 Then
Totv = Replace(Totv,0,DN)
Totv = Totv&DN&DN
Totv = left(Totv,2)
Else
Totv = DN&DN
End If
Tot = Tot &","& Totv &" MB"
End If

Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("StatusP.log", 1, True)
D2 = objRead2.ReadLine
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("Status.log", 1, True)
D2a = objRead2.ReadLine
If D2a = "cancelar" Then
	txt1.innerHTML = Replace(F1,"000000","8B0000") & "Download Interrompido!</FONT>"
	Set objFSO2 = Nothing
	Set objRead2 = Nothing
Exit Function
End If
If D2 = "stop" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Download Interrompido...</FONT>"
	Set objFSO2 = Nothing
	Set objRead2 = Nothing
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 2000, "VBScript")
Exit Function
End If
If D2 = "fail" Then
If Mode = "update" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Falha ao tentar baixar atualização...</FONT>"
ElseIf Mode = "install" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Falha ao tentar baixar tradução...</FONT>"
End If
	Set objFSO2 = Nothing
	Set objRead2 = Nothing
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 2000, "VBScript")
Exit Function
End If

Pt = point.value
D6 = SPD.value
D8 = RPD.value
D3 = "- "& Tam &" / "& Tot
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBar.log", 1, True)
D1 = objRead.ReadLine
D1c = Split(D1, "-")
   For i = 1 to (Ubound(D1c))
	D1 = D1c(1)
	D5 = D1c(2)
   Next
D1 = Replace(D1," ","")
If D5 = 1 Then

ElseIf D5 = 2 Then
idTimer = window.setTimeout("InstallD", 1, "VBScript")
Exit Function
End If
D1 = Percent
D1c = Split(D1, ",")
   For i = 1 to (Ubound(D1c))
	D1 = D1c(0)
   Next
D1 = D1
D4 = Percent/2
D4a = Percent/2
D4a = Replace(D4a,",",".")
D4c = Split(D4, ",")
   For i = 1 to (Ubound(D4c))
	D4 = D4c(0)
   Next
D7 = STSVR.value
If D7 > 0 Then
If D1 = "100" Then
txt3.innerHTML = Replace(F1,"8B0000","000000") & "</FONT>"
STSVR.value = 0
ElseIf D1 > D7 Then
txt3.innerHTML = Replace(F1,"8B0000","000000") & "</FONT>"
STSVR.value = 0
End If
End If
If D2 = "stsvr" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Conexão Perdida! Reconectando...</FONT>"
	If D1 = 0 Then
	STSVR.value = "1"
	Else
	STSVR.value = D1
	End If
	idTimer = window.setTimeout("Counter", 1, "VBScript")
Exit Function
End If
If D1 = 0 Then
	txt1.innerHTML = F1 & "Iniciando Download"& Pt &"</FONT>"
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Counter", 1, "VBScript")
ElseIf D1 = "100" Then
bar.style.width = D4a & "%"
If Mode = "update" Then
	 txt1.innerHTML = F1 & "Atualização Baixada! Extraindo"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	 txt1.innerHTML = F1 & "Tradução Baixada! Extraindo"& Pt &"</FONT>"
End If
	 txt2.innerHTML = F1 & D1 & "%</FONT>"
	 txt4.innerHTML = F1 & "Progresso Total: " & D4 & "%</FONT>"
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("InstallE", 1, "VBScript")
Else
PSP.value = "download"
bar.style.width = D4a & "%"
If Mode = "update" Then
	 txt1.innerHTML = F1 & "Baixando Atualização"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	 txt1.innerHTML = F1 & "Baixando Tradução"& Pt &"</FONT>"
End If
	 txt2.innerHTML = F1 & D1 & "% " & D3 & D6 & D8 &"</FONT>"
	 txt4.innerHTML = F1 & "Progresso Total: " & D4 & "%</FONT>"
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Counter", 1, "VBScript")
End If
Exit Function
   End Function
   Function InstallD()
PSP.value = "install"
txt1.innerHTML = F1 & "Instalando...</FONT>"
txt2.innerHTML = F1 & "</FONT>"
txt3.innerHTML = F1 & "</FONT>"
txt4.innerHTML = F1 & "</FONT>"
Bttn_N.style.display = "none"
idTimer = window.setTimeout("Install", 1, "VBScript")
Exit Function
   End Function
   Function InstallE()
PSP.value = "install"
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBar.log", 2, True)
objRead.WriteLine "0"
txt2.innerHTML = F1 & "</FONT>"
txt3.innerHTML = F1 & "</FONT>"
txt4.innerHTML = F1 & "</FONT>"
Bttn_N.style.display = "none"
idTimer = window.setTimeout("Install", 1, "VBScript")
Exit Function
   End Function
   Function Install()
On Error Resume Next
	 D1 = 0
	 D4 = 0
	 D5 = 0
Mode = "update"
PSP.value = "install"
Pt = point.value
arrCommands = Split(AppProgressUp.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Mode = arrCommands(4)
   Next
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("StatusP.log", 1, True)
D2 = objRead2.ReadLine
If D2 = "stop" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Instalação Interrompida...</FONT>"
	Set objFSO = Nothing
	Set objRead = Nothing
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 2000, "VBScript")
Exit Function
End If
If D2 = "fail" Then
If Mode = "update" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Falha ao tentar instalar atualização...</FONT>"
ElseIf Mode = "install" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Falha ao tentar instalar tradução...</FONT>"
End If
	Set objFSO = Nothing
	Set objRead = Nothing
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 2000, "VBScript")
Exit Function
End If
If D2 = "fselect" Then
	txt1.innerHTML = F1 & "Aguardando seleção de pasta"& Pt &"</FONT>"
	idTimer = window.setTimeout("Install", 1, "VBScript")
Exit Function
End If
If D2 = "ipinit" Then
	txt1.innerHTML = F1 & "Iniciando Instalação"& Pt &"</FONT>"
	idTimer = window.setTimeout("Install", 1, "VBScript")
Exit Function
End If
Set objFSO3 = CreateObject("Scripting.FileSystemObject")
Set objRead3 = objFSO3.OpenTextFile("ProgressT.log", 1, True)
D3 = objRead3.ReadLine
D3 = Replace(D3,"...",Pt)
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBar.log", 1, True)
D1 = objRead.ReadLine
D1c = Split(D1, "-")
   For i = 1 to (Ubound(D1c))
	D1 = D1c(1)
	D5 = D1c(2)
   Next
D1 = Replace(D1," ","")
If D5 = 1 Then

ElseIf D5 = 2 Then

End If
D4 = D1/2
D4e = D1/2
D4b = "50"
D4 = D4*1+D4b
D4a = D4e*1+D4b
D4a = Replace(D4a,",",".")
D4c = Split(D4, ",")
   For i = 1 to (Ubound(D4c))
	D4 = D4c(0)
   Next
If D1 = 0 Then
If D2 = 1 Then

Else
If Mode = "update" Then
	 txt1.innerHTML = F1 & "Atualização Baixada! Extraindo"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	 txt1.innerHTML = F1 & "Tradução Baixada! Extraindo"& Pt &"</FONT>"
End If
End If
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Install", 1, "VBScript")
ElseIf D1 = 100 Then
bar.style.width = D4a & "%"
If Mode = "update" Then
	txt1.innerHTML = F1 & "Atualização Instalada!</FONT>"
ElseIf Mode = "install" Then
	txt1.innerHTML = F1 & "Tradução Instalada!</FONT>"
End If
	 txt2.innerHTML = F1 & D1 & "%</FONT>"
	 txt4.innerHTML = F1 & "Progresso Total: " & D4 & "%</FONT>"
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Exit2", 1, "VBScript")
Else
bar.style.width = D4a & "%"
If Mode = "update" Then
	txt1.innerHTML = F1 & "Instalando Atualização"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	txt1.innerHTML = F1 & "Instalando Tradução"& Pt &"</FONT>"
End If
	 txt2.innerHTML = F1 & D1 & "% " & D3 & "</FONT>"
	 txt4.innerHTML = F1 & "Progresso Total: " & D4 & "%</FONT>"
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Install", 1, "VBScript")
End If
Exit Function
   End Function
'-> Cancel Action
   Function Cancel()
On Error Resume Next
PSP.value = "cancel"
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("Status.log", 2, True)
objRead.WriteLine "cancelar"
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Cancelando Download...</FONT>"
	Set objFSO = Nothing
	Set objRead = Nothing
Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")
Set colProcessList = objWMIService.ExecQuery("Select * from Win32_Process Where Name = 'wget.exe'")
For Each objProcess in colProcessList
	objProcess.Terminate()
Next
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 2000, "VBScript")
   Exit Function
   End Function
   Function Exit2()
On Error Resume Next
	 D1 = 0
	 D5 = 0
PSP.value = "error"
txt2.innerHTML = F1 & "</FONT>"
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBar.log", 1, True)
D1 = objRead.ReadLine
D1c = Split(D1, "-")
   For i = 1 to (Ubound(D1c))
	D1 = D1c(1)
	D5 = D1c(2)
   Next
Mode = "update"
arrCommands = Split(AppProgressUp.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Mode = arrCommands(4)
   Next
If D5 = 21 Then
If Mode = "update" Then
	txt1.innerHTML = F1 & "Atualização não Instalada! Tente Novamente!</FONT>"
	txt4.innerHTML = Replace(F1,"000000","8B0000") & "Erros durante a Atualização!</FONT>"
ElseIf Mode = "install" Then
	txt1.innerHTML = F1 & "Tradução não Instalada! Tente Novamente!</FONT>"
	txt4.innerHTML = Replace(F1,"000000","8B0000") & "Erros durante a Instalação!</FONT>"
End If
	window.clearTimeout(idTimer)
	OkB.style.display = "block"
Else
If Mode = "update" Then
	txt4.innerHTML = Replace(F1,"000000","008000") & "Tradução Atualizada com Sucesso!</FONT>"
ElseIf Mode = "install" Then
	txt4.innerHTML = Replace(F1,"000000","008000") & "Tradução Instalada com Sucesso!</FONT>"
End If
	window.clearTimeout(idTimer)
	OkB.style.display = "block"
End If
   Exit Function
   End Function
'-> Close The HTA Window
   Function HtaExit() 
On Error Resume Next
	window.clearTimeout(idTimer)
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("Status.log", 2, True)
objRead.WriteLine "cancelar"
	Set objFSO = Nothing
	Set objRead = Nothing
	idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
   End Function
'-> Close Function
   Function MyTimer2()
On Error Resume Next
	txt3.innerHTML = ""
	window.close()
	window.clearTimeout(idTimer)
   Exit Function
   End Function
'-> Close Verification
'
</script>
</head>
 <body scroll='No' onKeyDown='javascript:Verificar()' ondragstart='return false'>
 <div class='Pbar'><div id="bar" class="pgbar"></div></div>
 <table><td class='Type1'><span id='txt1'></span></td></table>
 <table><td class='Type1'><span id='txt2' class="txt2"></span></td></table>
 <table style='Margin-Top:7pt;Margin-Right:10pt;' align='Right'>
 <td><button id='Bttn_N' onclick='Cancel()'>Cancelar</button>
 <button id='OkB' onclick='MyTimer2()' style="display:none">OK</button></td>
 </table> 
<div class='server' id='server' align='Center' style="position:absolute;margin-left:189px;bottom:5px;display:none"><img id="serverlogo" name="serverlogo" src="tg.png"></img></div>
<table><td class='Type1'><span id='txt4' class="txt4"></span></td></table>
<table><td class='Type1'><span id='txt3' class="txt3"></span></td></table>
<input id="PSP" type="text" name="PSP" style="display:none" value="download" />
<input id="DSP" type="text" name="DSP" style="display:none" value="1" />
<input id="point" type="text" name="point" style="display:none" value="" />
<input id="SPD" type="text" name="SPD" style="display:none" value="" />
<input id="RPD" type="text" name="RPD" style="display:none" value="" />
<input id="STSVR" type="text" name="STSVR" style="display:none" value="0" />
 </body>
</html>
