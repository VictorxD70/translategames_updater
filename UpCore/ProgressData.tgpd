<div id='ProgressUI'>
<div id='PbarN' class='Pbar'><div id="bar" class="pgbar"></div></div>
<table><td class='Type1'><span id='txt1'></span></td></table>
<table><td class='Type1'><span id='txt2' class="txt2"></span></td></table>
<table style="position:absolute;margin-left:310px;bottom:10px;" align='Right'>
<td><button id='Bttn_N' class='bred' onclick='Cancel()' style="display:none">Cancelar</button></td>
</table>
<span id='txt6' style="position:absolute;margin-left:5px;bottom:10px;Font-Size:8.0pt;Font-Weight:Bold;display:none;"></span>
<div class='server' id='server' align='Center' style="position:absolute;margin-left:189px;bottom:5px;display:none;"><img id="serverlogo" class="serverlogo" style="display:none" title="" name="serverlogo" src="error.png"></img></div>
<table><td class='Type1'><span id='txt4' class="txt4"></span></td></table>
<table><td class='Type1'><span id='txt3' class="txt3"></span></td></table>
<input id="PSP" type="text" name="PSP" style="display:none" value="download" />
<input id="DSP" type="text" name="DSP" style="display:none" value="1" />
<input id="point" type="text" name="point" style="display:none" value="" />
<input id="SPD" type="text" name="SPD" style="display:none" value="" />
<input id="RPD" type="text" name="RPD" style="display:none" value="" />
<input id="STSVR" type="text" name="STSVR" style="display:none" value="0" />
<input id="serverimagecache" type="text" name="serverimagecache" style="display:none" value="" />
<input id="imagedatacache" type="text" name="imagedatacache" style="display:none" value="" />
<input id="totalsizecache" type="text" name="totalsizecache" style="display:none" value="" />
<input id="filesizecache" type="text" name="filesizecache" style="display:none" value="" />
<input id="filecache" type="text" name="filecache" style="display:none" value="" />
<input id="totalcache" type="text" name="totalcache" style="display:none" value="" />
<input id="clreturn" type="text" name="clreturn" style="display:none" value="2" />
<input id="ProgressTcache" type="text" name="ProgressTcache" style="display:none" value="Copiando Arquivos..." />
</div>
<div id='SEPage' style="display:none">
<div id='InfoImage' align='Left' style="position:absolute;margin-left:5px;margin-top:6px;height:140px;width:140px;display:none;"><img id="infoimg" style="height:140px;width:140px;" src=""></img></div>
<div id='InfoText' style="position:absolute;margin-top:30px;">
<table id='txt7T' style="margin-left:129px;font-size:13pt;"><td class='Type1'><span id='txt7'></span></td></table>
<table id='txt8T' style="margin-left:134px;font-size:10pt;"><td class='Type1'><span id='txt8'></span></td></table>
</div>
<div id='RestartButtons' style="display:none">
<table style="position:absolute;margin-left:160px;bottom:10px;" align='Right'>
<td><button id='RestartB' class='bgreen' onclick='RoutineRestart()' style="width:140px">Tentar Novamente</button></td>
</table>
<table style="position:absolute;margin-left:310px;bottom:10px;" align='Right'>
<td><button id='CancelB' class='bred' onclick='MyTimer2()'>Cancelar</button></td>
</table>
</div>
<table style="position:absolute;margin-left:310px;bottom:10px;" align='Right'>
<td><button id='OkB' class='bgreen' onclick='MyTimer2()' style="display:none">OK</button></td>
</table>
</div>
<$+*<P>*+$>
   Function ProgressStart()
On Error Resume Next
FunctionClock = 100
Boot.style.display = "none"
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("StatusPS.log", 1, False)
D2 = objRead2.ReadLine
Set objFSO2 = Nothing
Set objRead2 = Nothing
If D2 = "forceclose" Then
	idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
	Exit Function
End If
Set objFSOP = CreateObject("Scripting.FileSystemObject")
Set objReadP = objFSOP.OpenTextFile("ChangeLogIV.log", 1, False)
D1P = objReadP.ReadLine
Set objFSOP = Nothing
Set objReadP = Nothing
D1CL = Replace(D1P," ","")
If D1CL = 1 Then
ShowChangeLog()
ChangeLogReturn = clreturn.value
If ChangeLogReturn = 1 Then
ProgressStart2()
Exit Function
ElseIf ChangeLogReturn = 2 Then
idTimer = window.setTimeout("ProgressStart", FunctionClock, "VBScript")
Exit Function
Else
idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
Exit Function
End If
ElseIf D1CL = 2 Then
ProgressStart2()
Exit Function
Else
idTimer = window.setTimeout("ProgressStart", FunctionClock, "VBScript")
Exit Function
End If
   End Function
   Function ShowChangeLog()
On Error Resume Next
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("StatusPS.log", 1, False)
D2 = objRead2.ReadLine
Set objFSO2 = Nothing
Set objRead2 = Nothing
If D2 = "forceclose" Then
	idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
	Exit Function
End If
Set objFSOP = CreateObject("Scripting.FileSystemObject")
Set objReadP = objFSOP.OpenTextFile("ChangeLog.log", 1, False)
D1P = objReadP.ReadLine
Set objFSOP = Nothing
Set objReadP = Nothing
txt = Replace(D1P,"\n ",vbCrLf)
txt = Replace(txt,"\/","|")
txt = Replace(txt,"""","")
txtc = Split(txt, "\\")
   For i = 1 to (Ubound(txtc))
	Title = txtc(1)
	CLmsg = txtc(2)
   Next
If CLmsg = "" Then
Exit Function
End If
document.title = Title
resultado = msgbox(CLmsg,vbOKCancel,Title)
If resultado = vbOK Then 
    clreturn.value = 1
    Set FSO = CreateObject("Scripting.FileSystemObject") 
    Set OTF = FSO.OpenTextFile("Result.txt", 2, True) 
    OTF.WriteLine "continuar" 
    Set OTF = Nothing 
    Set FSO = Nothing
    Set objFSO = CreateObject("Scripting.FileSystemObject")
    Set objRead = objFSO.OpenTextFile("ChangeLogIV.log", 2, True)
    objRead.WriteLine "2"
    Set objFSO = Nothing
    Set objRead = Nothing
Else 
    clreturn.value = 0
    Set FSO = CreateObject("Scripting.FileSystemObject") 
    Set OTF = FSO.OpenTextFile("Result.txt", 2, True) 
    OTF.WriteLine "cancelar" 
    Set OTF = Nothing 
    Set FSO = Nothing 
End If
   End Function
   Function ProgressStart2()
On Error Resume Next
OSversion = VersionOS.value
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("Status.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing
If OSversion < 520000 Then
PbarN.style.width = "415px"
End If
	bar.style.width = "0%"
	txt1.innerHTML = F1 & "Iniciando Download...</FONT>"
	txt3.innerHTML = F1 & "</FONT>"
	txt4.innerHTML = F1 & "</FONT>"
	txt2.innerHTML = F1 & "</FONT>"
	idTimer = window.setTimeout("ImportFileData", 1, "VBScript")
	idTimer = window.setTimeout("CheckLimit", 5, "VBScript")
	idTimer = window.setTimeout("CheckFile", 10, "VBScript")
	idTimer = window.setTimeout("CheckTotal", 15, "VBScript")
	idTimer = window.setTimeout("ImportImageData", 20, "VBScript")
	idTimer = window.setTimeout("CheckSPD(""0"")", 50, "VBScript")
	idTimer = window.setTimeout("Counter", 100, "VBScript")
	idTimer = window.setTimeout("PointerP", 110, "VBScript")
	idTimer = window.setTimeout("PMonitor", 110, "VBScript")
	idTimer = window.setTimeout("ShowProgress", 120, "VBScript")
   End Function
   Function ShowProgress()
On Error Resume Next
	If UIMode.value = "progress" Then
	Progress.style.display = "block"
	End If
   End Function
   Function ImportFileData()
On Error Resume Next
FunctionClock = 100
Set objFSOP = CreateObject("Scripting.FileSystemObject")
Set objReadP = objFSOP.OpenTextFile("ProgressFile.log", 1, False)
D1P = objReadP.ReadLine
Set objFSOP = Nothing
Set objReadP = Nothing
D1Pc = Split(D1P, "-")
   For i = 1 to (Ubound(D1Pc))
	File = D1Pc(1)
	Total = D1Pc(2)
   Next
File = Replace(File," ","")
Total = Replace(Total," ","")
If File = "" Then
idTimer = window.setTimeout("ImportFileData", FunctionClock, "VBScript")
Else
filecache.value = File
totalcache.value = Total
End If
   End Function
   Function ImportImageData()
On Error Resume Next

OSversion = VersionOS.value
ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

Set objFSO = CreateObject("Scripting.FileSystemObject")
If NOT (objFSO.FileExists("ImageData.tgib64")) Then
DImage = ""
Else
Set objFSOI = CreateObject("Scripting.FileSystemObject")
Set objReadI = objFSOI.OpenTextFile("ImageData.tgib64", 1, False)
DImage = objReadI.ReadAll
Set objFSOI = Nothing
Set objReadI = Nothing
End If
Set objFSO = Nothing


DImagec = Split(DImage, "-!.!-")

DImageData = "*$|$*"

For Each ImageD In DImagec

If OSversion < 609999 Then
serverlogo.title = "O Windows XP e Vista não são compatíveis com imagens Base64!"
ErrorImage = "error.png"
DImageData = DImageData & ErrorImage &"*$|$*"
Else
If ImageD = "" Then
ErrorImage = ""
DImageData = DImageData & ErrorImage &"*$|$*"
Else
ImageDr = Split(ImageD, "+-!-+")
   For i = 1 to (Ubound(ImageDr))
	ImageID = ImageDr(0)
	ImageD = ImageDr(1)
   Next

DImageData = DImageData & ImageD &"*$|$*"
End If
End If

Next

imagedatacache.value = DImageData

idTimer = window.setTimeout("ServerCheck", 1, "VBScript")

   Exit Function
   End Function
   Function ImageShow(imageIDI)
On Error Resume Next
OSversion = VersionOS.value

NimageIDI = imageIDI + 1
CImageLoad = imagedatacache.value
CImageLoadS = Split(CImageLoad, "*$|$*")
   For i = 1 to (Ubound(CImageLoadS))
	ImageDTS = CImageLoadS(NimageIDI)
   Next

If OSversion < 609999 Then
ImageDTS = "error.png"
Else
If ImageDTS = "" Then
ImageDTS = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABMlBMVEVHcEwAAAAAAAACAgIAAAAFBQUAAAAdGxsAAAAAAAB9Hx4AAAAAAAAAAADDe3oZCQmbe3sAAABaFxYyDg0AAAAAAACqa2uRfn7Pk5OZJSNdGxrYkpEAAACoJSJIExNKHx4cCAitMzGFIyK7dHNZGBgMBQV7IiBqHx3ScW6uPjvYnZylcnKvaGjDgoKnZ2YAAAAEAgFsGxvDgH/Uqqm1eHfJe3iIUE+GMzGrQUA6GBcLAwNkGxubS0qtZGLiop+yammdIyJaGhlSHx4AAACNIiDaJR3riITvnZnDJiLRJR7tk4/ndG/IJSC9JiPwpqPpf3rMJR/ysa7UJR3dLibefnrcYVzst7bXJR30ure0JiTSTkraU064JyXwsa7nbmjfPjfqfnnlZV/dPjfFLyvMNTDRSURS8PFPAAAAVXRSTlMAJQY0LRMZAQx772E+XtEgJYzYvXBXhA/S72DpSfrMRav01ZLer7CH/vT0UKpzqIaZ5dVN1fTBxspYnMKLruXg9rdTKO7////////////////////+Vb828gAAATVJREFUeNp1k9dWwkAURWOKJDEJHRFEpNl77+hyzSRDegQRsJf//wWHN3045/XsO7Nm3zXC/xxaB6WMmBJQdh6f4pcjSUX9Nu+DwD6RRQCU4ziw7d6xOQuADT7e69G+dg+AKh+nNOxnZQBYfDx8/2hAYIuPu29Eh1eUwvD1gZBcIQ2Azb7Le7I0h16RWZv2Sb6oAGB+nfBEy4tIZWphCjh7hoiAJiHDYS0rwW2tsCRh+q4soKx6jLF9bQYCFYexCGrgqfuR50ENPOmR5zlYAxdRcxwfa5iK8P3RhSFioHKZy2tySoBRDNM0FAxkWjfV67qKgbJtU7d7Do9o2ZS6g8Ep/BgWdd3BeNyAps4+J5Of769buIyriIv0n9sQUJoO7/UOvEKU73S93Sng36vKRU0zpb8ifgHeGzVHydMjiQAAAABJRU5ErkJggg=="
Else
ImageDTS = ImageDTS
End If
End If

    ImageShow = ImageDTS
   End Function
   Function ServerCheck()
On Error Resume Next
FunctionClock = 150
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ServerP.log", 1, False)
D1 = objRead.ReadLine
Set objFSO = Nothing
Set objRead = Nothing
D1s = Replace(D1," ","")
D1s = D1s + 1
D1s = D1s - 1
D2s = DSP.value
D3s = PSP.value
OSversion = VersionOS.value
ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

If OSversion < 609999 Then
server.style.display = "none"
serverlogo.src = "error.png"
serverimagecache.value = "error"
End If

If NOT D3s = "download" Then
server.style.display = "none"
serverlogo.title = "Baixando com: Servidor Traduções de Jogos"
serverlogo.src = ImageShow(1)
serverimagecache.value = 1
server.style.backgroundcolor = "#FFFF00"
idTimer = window.setTimeout("ServerCheck", FunctionClock, "VBScript")
Exit Function
End If

If D2s = 1 Then
NsColor = "#FFFF00"
NbColor = "#FFFF00"
AltsColor = server.style.backgroundcolor
AltbColor = bar.style.backgroundcolor
If NOT AltsColor = NsColor Then
server.style.backgroundcolor = NsColor
End If
If NOT AltbColor = NbColor Then
bar.style.backgroundcolor = NbColor
End If
ElseIf D2s = 2 Then
NsColor = "#2BC253"
NbColor = "#2BC253"
AltsColor = server.style.backgroundcolor
AltbColor = bar.style.backgroundcolor
If NOT AltsColor = NsColor Then
server.style.backgroundcolor = NsColor
End If
If NOT AltbColor = NbColor Then
bar.style.backgroundcolor = NbColor
End If
End If

If D1s > 0 Then
server.style.display = "block"
Else
server.style.display = "none"
idTimer = window.setTimeout("ServerCheck", FunctionClock, "VBScript")
Exit Function
End If

If D1s = 1 Then
Ntitle = "Baixando com: Servidor Traduções de Jogos"
AltTitle = serverlogo.title
AltSrc = serverimagecache.value
If NOT AltTitle = Ntitle Then
serverlogo.title = Ntitle
End If
If NOT AltSrc = D1s Then
Nsrc = ImageShow(D1s)
serverlogo.src = Nsrc
End If
serverimagecache.value = D1s
serverlogo.style.display = "block"
ElseIf D1s = 2 Then
Ntitle = "Baixando com: Servidor GitHub"
AltTitle = serverlogo.title
AltSrc = serverimagecache.value
If NOT AltTitle = Ntitle Then
serverlogo.title = Ntitle
End If
If NOT AltSrc = D1s Then
Nsrc = ImageShow(D1s)
serverlogo.src = Nsrc
End If
serverimagecache.value = D1s
serverlogo.style.display = "block"
ElseIf D1s = "" Then
server.style.display = "none"
Ntitle = "Baixando com: Servidor Traduções de Jogos"
AltTitle = serverlogo.title
AltSrc = serverimagecache.value
If NOT AltTitle = Ntitle Then
serverlogo.title = Ntitle
End If
If NOT AltSrc = 1 Then
Nsrc = ImageShow(1)
serverlogo.src = Nsrc
End If
serverimagecache.value = 1
serverlogo.style.display = "block"
Else
Ntitle = "Baixando com: Servidor Desconhecido"
ErrorImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABMlBMVEVHcEwAAAAAAAACAgIAAAAFBQUAAAAdGxsAAAAAAAB9Hx4AAAAAAAAAAADDe3oZCQmbe3sAAABaFxYyDg0AAAAAAACqa2uRfn7Pk5OZJSNdGxrYkpEAAACoJSJIExNKHx4cCAitMzGFIyK7dHNZGBgMBQV7IiBqHx3ScW6uPjvYnZylcnKvaGjDgoKnZ2YAAAAEAgFsGxvDgH/Uqqm1eHfJe3iIUE+GMzGrQUA6GBcLAwNkGxubS0qtZGLiop+yammdIyJaGhlSHx4AAACNIiDaJR3riITvnZnDJiLRJR7tk4/ndG/IJSC9JiPwpqPpf3rMJR/ysa7UJR3dLibefnrcYVzst7bXJR30ure0JiTSTkraU064JyXwsa7nbmjfPjfqfnnlZV/dPjfFLyvMNTDRSURS8PFPAAAAVXRSTlMAJQY0LRMZAQx772E+XtEgJYzYvXBXhA/S72DpSfrMRav01ZLer7CH/vT0UKpzqIaZ5dVN1fTBxspYnMKLruXg9rdTKO7////////////////////+Vb828gAAATVJREFUeNp1k9dWwkAURWOKJDEJHRFEpNl77+hyzSRDegQRsJf//wWHN3045/XsO7Nm3zXC/xxaB6WMmBJQdh6f4pcjSUX9Nu+DwD6RRQCU4ziw7d6xOQuADT7e69G+dg+AKh+nNOxnZQBYfDx8/2hAYIuPu29Eh1eUwvD1gZBcIQ2Azb7Le7I0h16RWZv2Sb6oAGB+nfBEy4tIZWphCjh7hoiAJiHDYS0rwW2tsCRh+q4soKx6jLF9bQYCFYexCGrgqfuR50ENPOmR5zlYAxdRcxwfa5iK8P3RhSFioHKZy2tySoBRDNM0FAxkWjfV67qKgbJtU7d7Do9o2ZS6g8Ep/BgWdd3BeNyAps4+J5Of769buIyriIv0n9sQUJoO7/UOvEKU73S93Sng36vKRU0zpb8ifgHeGzVHydMjiQAAAABJRU5ErkJggg=="
AltTitle = serverlogo.title
AltSrc = serverimagecache.value
If NOT AltTitle = Ntitle Then
serverlogo.title = Ntitle
End If
If NOT AltSrc = "error" Then
Nsrc = ErrorImage
serverlogo.src = Nsrc
End If
serverimagecache.value = "error"
serverlogo.style.display = "block"
End If

idTimer = window.setTimeout("ServerCheck", FunctionClock, "VBScript")
   Exit Function
   End Function
   Function PMonitor()
On Error Resume Next
FunctionClock = 600

ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

Pt = point.value
Data = txt3.innerHTML
Datac = Split(Data, ">")
   For i = 1 to (Ubound(Datac))
	Data1 = Datac(0)
	Data2 = Datac(1)
   Next
Datac = Split(Data2, "<")
   For i = 1 to (Ubound(Datac))
	DataT = Datac(0)
   Next
If DataT = "" Then

Else
Data3 = Replace(DataT,"...","")
Data3 = Replace(Data3,"..","")
Data3 = Replace(Data3,".","")
Data3 = Data3&Pt
Data = Data1 &">"& Data3 &"</font>"
txt3.innerHTML = Data
End If
idTimer = window.setTimeout("PMonitor", FunctionClock, "VBScript")
   Exit Function
   End Function
   Function PointerP()
On Error Resume Next
FunctionClock = 600
Pt = point.value
Pit0 = ""
Pit1 = "."
Pit2 = ".."
Pit3 = "..."
If Pt = Pit1 Then
point.value = Pit2
idTimer = window.setTimeout("PointerP", FunctionClock, "VBScript")
Exit Function
ElseIf Pt = Pit2 Then
point.value = Pit3
idTimer = window.setTimeout("PointerP", FunctionClock, "VBScript")
Exit Function
ElseIf Pt = Pit3 Then
point.value = Pit0
idTimer = window.setTimeout("PointerP", FunctionClock, "VBScript")
Exit Function
ElseIf Pt = Pit0 Then
point.value = Pit1
idTimer = window.setTimeout("PointerP", FunctionClock, "VBScript")
Exit Function
End If
   Exit Function
   End Function
Function CheckTotal()
Dim D2, File
On Error Resume Next
FunctionClock = 2000

ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

File = filecache.value

If File = "" Then
totalsizecache.value = 0
idTimer = window.setTimeout("CheckTotal", FunctionClock, "VBScript")
Exit Function
End If

Set objFSO = CreateObject("Scripting.FileSystemObject")
If NOT (objFSO.FileExists("UpdateLog.txt")) Then
totalsizecache.value = 0
idTimer = window.setTimeout("CheckTotal", FunctionClock, "VBScript")
Exit Function
End If
Set objFSO = Nothing

Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("UpdateLog.txt", 1, False)
D2 = objRead2.ReadAll
Set objFSO2 = Nothing
Set objRead2 = Nothing

D2r = Split(D2, "Saving to: '"&File&"'")
Filet = Ubound(D2r)
Filet = Filet - 1
Filet2 = D2r(Filet)
D2r = Split(Filet2, "Length: ")
Filet = Ubound(D2r)
Filet2 = D2r(Filet)
D2r = Split(Filet2, " [")
Filet = 0
Filet2 = D2r(Filet)
D2r = Split(Filet2, " (")
Filet = 0
Filet2 = D2r(Filet)

D2dataR = Filet2

If D2dataR = "" Then
D2dataR = 0
End If

totalsizecache.value = D2dataR

idTimer = window.setTimeout("CheckTotal", FunctionClock, "VBScript")
   Exit Function
   End Function
   Function CheckFile()
On Error Resume Next
FunctionClock = 64

ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

File = filecache.value

If File = "" Then
idTimer = window.setTimeout("CheckFile", FunctionClock, "VBScript")
Exit Function
End If

Set objFSO2 = CreateObject("Scripting.FileSystemObject")
If NOT (objFSO2.FileExists(File)) Then
idTimer = window.setTimeout("CheckFile", FunctionClock, "VBScript")
Exit Function
End If
Set objFSO2 = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.GetFile(File)
FileSizeData = objFile.SIZE
Set objFSO = Nothing
Set objRead = Nothing

If FileSizeData = "" Then
FileSizeData = 0
End If

filesizecache.value = FileSizeData

idTimer = window.setTimeout("CheckFile", FunctionClock, "VBScript")
   Exit Function
   End Function
   Function CheckLimit()
On Error Resume Next
FunctionClock = 3000

ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

Code = "0"
arrCommands = Split(AppUpdaterUI.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Code = arrCommands(3)
   Next

If Code = "0" Then
Exit Function
End If

Set oShell = CreateObject("WScript.Shell")

If code = "350" Then
config = oShell.RegRead("HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\TranslateGames(350-1)\UpConfig")
Else
config = oShell.RegRead("HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\TranslateGames("& code &")\UpConfig")
End If
If (config) Then
config = Split(config, "|.|")
   For i = 1 to (Ubound(config))
	AutoOp = config(0)
	TimeOp = config(1)
	LimitOp = config(2)
   Next
Else
idTimer = window.setTimeout("CheckLimit", FunctionClock, "VBScript")
Exit Function
End If

Limit = ""
If LimitOp = "0" Then
LimitOp = "Ilimitado"
End If
If LimitOp = "Ilimitado" Then
Limit = ""
ElseIf LimitOp = "50k" Then
Limit = "50 KB/s"
ElseIf LimitOp = "100k" Then
Limit = "100 KB/s"
ElseIf LimitOp = "300k" Then
Limit = "300 KB/s"
ElseIf LimitOp = "500k" Then
Limit = "500 KB/s"
ElseIf LimitOp = "1m" Then
Limit = "1 MB/s"
ElseIf LimitOp = "2m" Then
Limit = "2 MB/s"
ElseIf LimitOp = "5m" Then
Limit = "5 MB/s"
End If

If Limit = "" Then
Limit = ""
Else
txt6.innerHTML = Replace(F1,"000000","8B0000") & Limit &"</FONT>"
txt6.title = "Download Limitado em "&Limit
End If

   Exit Function
   End Function
   Function CheckSPD(D1)
On Error Resume Next
FunctionClock = 1000

ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

	D6 = 0
	D7 = 0
	DN = Chr(48)
Total = totalcache.value
TotalChk = totalsizecache.value
If TotalChk = 0 Then
Total = Total
Else
Total = TotalChk
End If
D3 = filesizecache.value
D7 = D3
If D3 > 0 Then
D3 = Replace(D3,0,DN)
D6 = D3-D1
D8 = D3-D1
If D8 = 0 Then
DSP.value = 1
ElseIf D8 < 0 Then
DSP.value = 1
ElseIf D8 > 0 Then
DSP.value = 2
End If
If D8 < 0 Then
SPD.value = ""
ElseIf D8 = 0 Then
SPD.value = ""
ElseIf D8 < 1024 Then
SPD.value = " - "& D8 &" B/s"
ElseIf D8 > 1023999 Then
D6 = D6/1024/1024
D6c = Split(D6, GetDecimalChar)
   For i = 1 to (Ubound(D6c))
	D6 = D6c(0)
	D6v = D6c(1)
   Next
D6v = Replace(D6v,0,DN)
D6v = left(D6v,2)
D6 = Replace(D6,0,DN)
If D6v = 0 Then
D6v = DN&DN
ElseIf D6v > 0 Then
D6v = Replace(D6v,0,DN)
D6v = D6v&DN&DN
D6v = left(D6v,2)
Else
D6v = DN&DN
End If
If D6v = 0 Then
D6 = D6
Else
D6 = D6 &","& D6v
End If
SPD.value = " - "& D6 &" MB/s"
ElseIf D8 < 1024000 Then
D6 = D6/1024
D6c = Split(D6, GetDecimalChar)
   For i = 1 to (Ubound(D6c))
	D6 = D6c(0)
	D6v = D6c(1)
   Next
D6 = Replace(D6,0,DN)
SPD.value = " - "& D6 &" KB/s"
End If
End If
Rest = Total-D7
Restc = Split(Rest, GetDecimalChar)
   For i = 1 to (Ubound(Restc))
	Rest = Restc(0)
	Restv = Restc(1)
   Next
Seg = Rest/D8
Segc = Split(Seg, GetDecimalChar)
   For i = 1 to (Ubound(Segc))
	Seg = Segc(0)
	Segv = Segc(1)
   Next
If Seg < 0 Then
RPD.value = ""
ElseIf Seg = 0 Then
RPD.value = ""
ElseIf Seg > 3599 Then
SegH = Seg/60/60
SegHc = Split(SegH, GetDecimalChar)
   For i = 1 to (Ubound(SegHc))
	SegH = SegHc(0)
	SegHv = SegHc(1)
   Next
SegM = SegH*60*60
SegM = Seg-SegM
SegM = SegM/60
SegMc = Split(SegM, GetDecimalChar)
   For i = 1 to (Ubound(SegMc))
	SegM = SegMc(0)
	SegMv = SegMc(1)
   Next
SegS = SegM*60
SegS = Seg+SegS
SegS = SegS-Seg
If SegS = 0 Then
RPD.value = " "& SegH &"h "& SegM &"m restantes"
ElseIf SegM = 0 Then
RPD.value = " "& SegH &"h "& SegS &"s restantes"
Else
RPD.value = " "& SegH &"h "& SegM &"m "& SegS &"s restantes"
End If
ElseIf Seg > 59 Then
SegM = Seg/60
SegMc = Split(SegM, GetDecimalChar)
   For i = 1 to (Ubound(SegMc))
	SegM = SegMc(0)
	SegMv = SegMc(1)
   Next
SegS = SegM*60
SegS = Seg-SegS
If SegS = 0 Then
RPD.value = " "& SegM &"m restantes"
Else
RPD.value = " "& SegM &"m "& SegS &"s restantes"
End If
Else
RPD.value = " "& Seg &"s restantes"
End If
idTimer = window.setTimeout("CheckSPD("""&D7&""")", FunctionClock, "VBScript")
Exit Function
   End Function
'-> Count Down Function
   Function Counter()
On Error Resume Next
FunctionClock = 65

ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

	 D1 = 0
	 D4 = 0
	 D5 = 0
	 DN = Chr(48)
Mode = "update"
arrCommands = Split(AppUpdaterUI.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Mode = arrCommands(2)
   Next

Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("UpdateMode.log", 1, False)
D2 = objRead2.ReadLine
Set objFSO2 = Nothing
Set objRead2 = Nothing
If D2 = "update" Then
	Mode = "update"
ElseIf D2 = "install" Then
	Mode = "install"
Else
	Mode = Mode
End If

Total = totalcache.value

TotalChk = totalsizecache.value
If TotalChk = 0 Then
Total = Total
Else
Total = TotalChk
End If
ASize = filesizecache.value

TotalSize = Total/100
Percent = ASize/TotalSize
Tam = ASize
Tam2 = Tam
Tam3 = Tam/1024
Tam3c = Split(Tam3, GetDecimalChar)
   For i = 1 to (Ubound(Tam3c))
	Tam3 = Tam3c(0)
	Tam3v = Tam3c(1)
   Next
Tam3v = Replace(Tam3v,0,DN)
Tam3v = left(Tam3v,2)
Tam3 = Replace(Tam3,0,DN)
If Tam3v = 0 Then
Tam3v = DN&DN
ElseIf Tam3v > 0 Then
Tam3v = Replace(Tam3v,0,DN)
Tam3v = Tam3v&DN&DN
Tam3v = left(Tam3v,2)
Else
Tam3v = DN&DN
End If
If Tam3 < 100 Then
Tam3 = Tam3 &","& Tam3v
End If
Tam = Tam3 &" KB"
If Tam2 < 1024 Then
Tam = ASize &" B"
ElseIf Tam2 > 1023999 Then
Tam = Tam2/1024/1024
Tamc = Split(Tam, GetDecimalChar)
   For i = 1 to (Ubound(Tamc))
	Tam = Tamc(0)
	Tamv = Tamc(1)
   Next
Tamv = Replace(Tamv,0,DN)
Tamv = left(Tamv,2)
Tam = Replace(Tam,0,DN)
If Tamv = 0 Then
Tamv = DN&DN
ElseIf Tamv > 0 Then
Tamv = Replace(Tamv,0,DN)
Tamv = Tamv&DN&DN
Tamv = left(Tamv,2)
Else
Tamv = DN&DN
End If
Tam = Tam &","& Tamv &" MB"
End If
Tot = Total
Tot2 = Tot
Tot3 = Tot/1024
Tot3c = Split(Tot3, GetDecimalChar)
   For i = 1 to (Ubound(Tot3c))
	Tot3 = Tot3c(0)
	Tot3v = Tot3c(1)
   Next
Tot3v = Replace(Tot3v,0,DN)
Tot3v = left(Tot3v,2)
Tot3 = Replace(Tot3,0,DN)
If Tot3v = 0 Then
Tot3v = DN&DN
ElseIf Tot3v > 0 Then
Tot3v = Replace(Tot3v,0,DN)
Tot3v = Tot3v&DN&DN
Tot3v = left(Tot3v,2)
Else
Tot3v = DN&DN
End If
If Tot3 < 100 Then
Tot3 = Tot3 &","& Tot3v
End If
Tot = Tot3 &" KB"
If Tot2 < 1024 Then
Tam = Total &" B"
ElseIf Tot2 > 1023999 Then
Tot = Tot2/1024/1024
Totc = Split(Tot, GetDecimalChar)
   For i = 1 to (Ubound(Totc))
	Tot = Totc(0)
	Totv = Totc(1)
   Next
Totv = Replace(Totv,0,DN)
Totv = left(Totv,2)
Tot = Replace(Tot,0,DN)
If Totv = 0 Then
Totv = DN&DN
ElseIf Totv > 0 Then
Totv = Replace(Totv,0,DN)
Totv = Totv&DN&DN
Totv = left(Totv,2)
Else
Totv = DN&DN
End If
Tot = Tot &","& Totv &" MB"
End If

Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("StatusPS.log", 1, False)
D2 = objRead2.ReadLine
Set objFSO2 = Nothing
Set objRead2 = Nothing
If D2 = "forceclose" Then
	idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
	Exit Function
End If
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("StatusP.log", 1, False)
D2 = objRead2.ReadLine
Set objFSO2 = Nothing
Set objRead2 = Nothing
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("Status.log", 1, False)
D2a = objRead2.ReadLine
Set objFSO2 = Nothing
Set objRead2 = Nothing
If D2a = "cancelar" Then
	txt1.innerHTML = Replace(F1,"000000","8B0000") & "Download Interrompido!</FONT>"
Exit Function
End If
If D2 = "stop" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Download Interrompido...</FONT>"
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 2000, "VBScript")
Exit Function
End If
If D2 = "fail" Then
	txt1.innerHTML = Replace(F1,"000000","8B0000") & "Download Interrompido!</FONT>"
If Mode = "update" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Falha ao tentar baixar atualização...</FONT>"
ElseIf Mode = "install" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Falha ao tentar baixar tradução...</FONT>"
End If
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 2000, "VBScript")
Exit Function
End If

txt6.style.display = "block"
Pt = point.value
D6 = SPD.value
D8 = RPD.value
D3 = "- "& Tam &" / "& Tot
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBar.log", 1, False)
D1 = objRead.ReadLine
Set objFSO = Nothing
Set objRead = Nothing
D1c = Split(D1, "-")
   For i = 1 to (Ubound(D1c))
	D1 = D1c(1)
	D5 = D1c(2)
   Next
D1 = Replace(D1," ","")
If D5 = 1 Then
bar.style.width = "50%"
idTimer = window.setTimeout("ExtractD", 1, "VBScript")
Exit Function
ElseIf D5 = 2 Then
bar.style.width = "50%"
idTimer = window.setTimeout("InstallD", 1, "VBScript")
Exit Function
End If
D1 = Percent
D1c = Split(D1, GetDecimalChar)
   For i = 1 to (Ubound(D1c))
	D1 = D1c(0)
   Next
D1 = D1
D4 = Percent/2
D4a = Percent/2
D4a = Replace(D4a,GetDecimalChar,".")
D4c = Split(D4, GetDecimalChar)
   For i = 1 to (Ubound(D4c))
	D4 = D4c(0)
   Next
D7 = STSVR.value
If D7 > 0 Then
If ASize = 0 Then
txt3.innerHTML = Replace(F1,"8B0000","000000") & "</FONT>"
STSVR.value = 0
ElseIf ASize = Total Then
txt3.innerHTML = Replace(F1,"8B0000","000000") & "</FONT>"
STSVR.value = 0
ElseIf ASize > D7 Then
txt3.innerHTML = Replace(F1,"8B0000","000000") & "</FONT>"
STSVR.value = 0
End If
End If
If D2 = "stsvr" Then
	If ASize > 0 Then
	document.title = "Conexão Perdida! Reconectando..."
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Conexão Perdida! Reconectando"& Pt &"</FONT>"
	End If
	If ASize = 0 Then
	STSVR.value = "1"
	Else
	STSVR.value = ASize
	End If
	idTimer = window.setTimeout("Counter", FunctionClock, "VBScript")
Exit Function
End If
If D1 = 0 Then
	Data = txt1.innerHTML
	Datac = Split(Data, ">")
	   For i = 1 to (Ubound(Datac))
		Data1 = Datac(0)
		Data2 = Datac(1)
	   Next
	Datac = Split(Data2, "<")
	   For i = 1 to (Ubound(Datac))
		DataT = Datac(0)
	   Next
	DataT = Replace(DataT,".","")
	If DataT = "" Then
	
	ElseIf DataT = "Iniciando Download" Then
	Data3 = DataT&Pt
	Data = Data1 &">"& Data3 &"</font>"
	txt1.innerHTML = Data
	ElseIf DataT = "Reiniciando Download" Then
	Data3 = DataT&Pt
	Data = Data1 &">"& Data3 &"</font>"
	txt1.innerHTML = Data
	End If
	Set objFSO = Nothing
	Set objRead = Nothing
idTimer = window.setTimeout("Counter", FunctionClock, "VBScript")
ElseIf D1 = "100" Then
bar.style.width = D4a&"%"
If Mode = "update" Then
	 document.title = "Validando Atualização..."
	 txt1.innerHTML = F1 & "Validando Atualização"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	 document.title = "Validando Tradução..."
	 txt1.innerHTML = F1 & "Validando Tradução"& Pt &"</FONT>"
End If
	 txt2.innerHTML = F1 & D1 & "%</FONT>"
	 txt4.innerHTML = F1 & "Progresso Total: " & D4 & "%</FONT>"
idTimer = window.setTimeout("InstallE", 1, "VBScript")
Else
Bttn_N.style.display = "block"
PSP.value = "download"
bar.style.width = D4a&"%"
If Mode = "update" Then
	 If D7 = 0 Then
	 document.title = "Baixando Atualização... "&D1&"%"
	 End If
	 txt1.innerHTML = F1 & "Baixando Atualização"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	 If D7 = 0 Then
	 document.title = "Baixando Tradução... "&D1&"%"
	 End If
	 txt1.innerHTML = F1 & "Baixando Tradução"& Pt &"</FONT>"
End If
	 txt2.innerHTML = F1 & D1 & "% " & D3 & D6 & D8 &"</FONT>"
	 txt4.innerHTML = F1 & "Progresso Total: " & D4 & "%</FONT>"
idTimer = window.setTimeout("Counter", FunctionClock, "VBScript")
End If
Exit Function
   End Function
   Function ExtractD()

ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

PSP.value = "install"
Pt = point.value
bar.style.backgroundcolor = "#2BC253"
txt1.innerHTML = F1 & "Extraindo...</FONT>"
txt2.innerHTML = F1 & "</FONT>"
txt3.innerHTML = F1 & "</FONT>"
txt4.innerHTML = F1 & "</FONT>"
txt6.style.display = "none"
Bttn_N.style.display = "none"
idTimer = window.setTimeout("Install", 1, "VBScript")
Exit Function
   End Function
   Function InstallD()

ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

PSP.value = "install"
bar.style.backgroundcolor = "#2BC253"
txt1.innerHTML = F1 & "Instalando...</FONT>"
txt2.innerHTML = F1 & "</FONT>"
txt3.innerHTML = F1 & "</FONT>"
txt4.innerHTML = F1 & "</FONT>"
txt6.style.display = "none"
Bttn_N.style.display = "none"
idTimer = window.setTimeout("Install", 1, "VBScript")
Exit Function
   End Function
   Function InstallE()

ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

PSP.value = "install"
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBar.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing
bar.style.backgroundcolor = "#2BC253"
txt2.innerHTML = F1 & "</FONT>"
txt3.innerHTML = F1 & "</FONT>"
txt4.innerHTML = F1 & "</FONT>"
txt6.style.display = "none"
Bttn_N.style.display = "none"
idTimer = window.setTimeout("Install", 1, "VBScript")
Exit Function
   End Function
   Function InstallFS()
On Error Resume Next
FunctionClock = 65
Pt = point.value
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("StatusP.log", 1, False)
D2 = objRead2.ReadLine
Set objFSO2 = Nothing
Set objRead2 = Nothing
If D2 = "fselect" Then
	bar.style.backgroundcolor = "#FFFF00"
	txt1.innerHTML = F1 & "Aguardando seleção de pasta"& Pt &"</FONT>"
	idTimer = window.setTimeout("InstallFS", FunctionClock, "VBScript")
Exit Function
Else
	bar.style.backgroundcolor = "#2BC253"
	idTimer = window.setTimeout("Install", 1, "VBScript")
Exit Function
End If
   Exit Function
   End Function
   Function Install()
On Error Resume Next
FunctionClock = 65

ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If

	 D1 = 0
	 D4 = 0
	 D5 = 0
Mode = "update"
PSP.value = "install"
Pt = point.value
arrCommands = Split(AppUpdaterUI.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Mode = arrCommands(2)
	Code = arrCommands(3)
   Next
GameName = "0"
If code = "350" Then
GameName = "Dawn of War e Winter Assault"
ElseIf code = "350-3" Then
GameName = "Dawn of War - Dark Crusade"
ElseIf code = "350-4" Then
GameName = "Dawn of War - Soulstorm"
ElseIf code = "356" Then
GameName = "Age of Mythology"
ElseIf code = "356-2" Then
GameName = "Age of Mythology: The Titans Expansion"
ElseIf code = "357" Then
GameName = "Dawn of War II - Retribution"
ElseIf code = "358" Then
GameName = "Dawn of War II e Chaos Rising"
End If
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("UpdateMode.log", 1, False)
D2 = objRead2.ReadLine
Set objFSO2 = Nothing
Set objRead2 = Nothing
If D2 = "update" Then
	Mode = "update"
ElseIf D2 = "install" Then
	Mode = "install"
Else
	Mode = Mode
End If
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("StatusPS.log", 1, False)
D2 = objRead2.ReadLine
Set objFSO2 = Nothing
Set objRead2 = Nothing
If D2 = "forceclose" Then
	idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
	Exit Function
End If
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("StatusP.log", 1, False)
D2 = objRead2.ReadLine
Set objFSO2 = Nothing
Set objRead2 = Nothing
If D2 = "stop" Then
	bar.style.backgroundcolor = "rgb(243,64,64)"
	txt1.innerHTML = F1 & "</FONT>"
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Instalação Interrompida...</FONT>"
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 2000, "VBScript")
Exit Function
End If
If D2 = "fail" Then
	bar.style.backgroundcolor = "rgb(243,64,64)"
	txt1.innerHTML = Replace(F1,"000000","8B0000") & "Instalação Interrompida!</FONT>"
If Mode = "update" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Falha ao tentar instalar atualização...</FONT>"
ElseIf Mode = "install" Then
	txt3.innerHTML = Replace(F1,"000000","8B0000") & "Falha ao tentar instalar tradução...</FONT>"
End If
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 2000, "VBScript")
Exit Function
End If
If D2 = "checkerror" Then
	bar.style.backgroundcolor = "rgb(243,64,64)"
	window.clearTimeout(idTimer)
	ExitMSG2("checkerror")
Exit Function
End If
If D2 = "fselect" Then
	bar.style.backgroundcolor = "#FFFF00"
	If GameName = "0" Then
	document.title = "Atualizador da Tradução"
	Else
	document.title = "Atualizador da Tradução de "&GameName
	End If
	txt1.innerHTML = F1 & "Aguardando seleção de pasta"& Pt &"</FONT>"
	idTimer = window.setTimeout("InstallFS", 1, "VBScript")
Exit Function
End If
If D2 = "ipinit" Then
	document.title = "Iniciando Instalação..."
	txt1.innerHTML = F1 & "Iniciando Instalação"& Pt &"</FONT>"
	idTimer = window.setTimeout("Install", FunctionClock, "VBScript")
Exit Function
End If
Set objFSO3 = CreateObject("Scripting.FileSystemObject")
Set objRead3 = objFSO3.OpenTextFile("ProgressT.log", 1, False)
D3 = objRead3.ReadLine
Set objFSO3 = Nothing
Set objRead3 = Nothing
If D3 = "" Then
D3 = ProgressTcache.value
Else
ProgressTcache.value = D3
End If
D3 = Replace(D3,"...",Pt)
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBar.log", 1, False)
D1 = objRead.ReadLine
Set objFSO = Nothing
Set objRead = Nothing
D1c = Split(D1, "-")
   For i = 1 to (Ubound(D1c))
	D1 = D1c(1)
	D5 = D1c(2)
   Next
D1 = Replace(D1," ","")
If D5 = 90 Then
If GameName = "0" Then
document.title = "Atualizador da Tradução"
Else
document.title = "Atualizador da Tradução de "&GameName
End If
txt1.innerHTML = F1 & "Reiniciando Download...</FONT>"
txt3.innerHTML = F1 & "</FONT>"
txt4.innerHTML = F1 & "</FONT>"
txt2.innerHTML = F1 & "</FONT>"
bar.style.width = "0%"
idTimer = window.setTimeout("Counter", 1, "VBScript")
Exit Function
ElseIf D5 = 1 Then
If D2 = 1 Then

Else
If D1 < 1 Then
If Mode = "update" Then
	 document.title = "Validando Atualização..."
	 txt1.innerHTML = F1 & "Validando Atualização"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	 document.title = "Validando Tradução..."
	 txt1.innerHTML = F1 & "Validando Tradução"& Pt &"</FONT>"
End If
Else
If Mode = "update" Then
	 document.title = "Extraindo... "&D1&"%"
	 txt1.innerHTML = F1 & "Extraindo "& D1 &"%"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	 document.title = "Extraindo... "&D1&"%"
	 txt1.innerHTML = F1 & "Extraindo "& D1 &"%"& Pt &"</FONT>"
End If
End If
End If
idTimer = window.setTimeout("Install", FunctionClock, "VBScript")
Exit Function
ElseIf D5 = 2 Then

End If
D4 = D1/2
D4e = D1/2
D4b = "50"
D4 = D4*1+D4b
D4a = D4e*1+D4b
D4a = Replace(D4a,GetDecimalChar,".")
D4c = Split(D4, GetDecimalChar)
   For i = 1 to (Ubound(D4c))
	D4 = D4c(0)
   Next
If D1 = 0 Then
idTimer = window.setTimeout("Install", FunctionClock, "VBScript")
ElseIf D1 = 100 Then
bar.style.width = D4a&"%"
If Mode = "update" Then
	If GameName = "0" Then
	document.title = "Atualizador da Tradução"
	Else
	document.title = "Atualizador da Tradução de "&GameName
	End If
	txt1.innerHTML = F1 & "Atualização Instalada!</FONT>"
ElseIf Mode = "install" Then
	If GameName = "0" Then
	document.title = "Atualizador da Tradução"
	Else
	document.title = "Atualizador da Tradução de "&GameName
	End If
	txt1.innerHTML = F1 & "Tradução Instalada!</FONT>"
End If
	 txt2.innerHTML = F1 & D1 & "%</FONT>"
	 txt4.innerHTML = F1 & "Progresso Total: " & D4 & "%</FONT>"
idTimer = window.setTimeout("Exit2", 1, "VBScript")
Else
bar.style.width = D4a&"%"
If Mode = "update" Then
	document.title = "Instalando Atualização... "&D1&"%"
	txt1.innerHTML = F1 & "Instalando Atualização"& Pt &"</FONT>"
ElseIf Mode = "install" Then
	document.title = "Instalando Tradução... "&D1&"%"
	txt1.innerHTML = F1 & "Instalando Tradução"& Pt &"</FONT>"
End If
	 txt2.innerHTML = F1 & D1 & "% " & D3 & "</FONT>"
	 txt4.innerHTML = F1 & "Progresso Total: " & D4 & "%</FONT>"
idTimer = window.setTimeout("Install", FunctionClock, "VBScript")
End If
Exit Function
   End Function
'-> Cancel Action
   Function Cancel()
On Error Resume Next

ModeUI = UIMode.value
If NOT ModeUI = "progress" Then
Exit Function
End If
D3P = PSP.value
If NOT D3P = "download" Then
Exit Function
End If

arrCommands = Split(AppUpdaterUI.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Code = arrCommands(3)
   Next
GameName = "0"
If code = "350" Then
GameName = "Dawn of War e Winter Assault"
ElseIf code = "350-3" Then
GameName = "Dawn of War - Dark Crusade"
ElseIf code = "350-4" Then
GameName = "Dawn of War - Soulstorm"
ElseIf code = "356" Then
GameName = "Age of Mythology"
ElseIf code = "356-2" Then
GameName = "Age of Mythology: The Titans Expansion"
ElseIf code = "357" Then
GameName = "Dawn of War II - Retribution"
ElseIf code = "358" Then
GameName = "Dawn of War II e Chaos Rising"
End If

Bttn_N.style.display = "none"
PSP.value = "cancel"
If GameName = "0" Then
document.title = "Atualizador da Tradução"
Else
document.title = "Atualizador da Tradução de "&GameName
End If
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("Status.log", 2, True)
objRead.WriteLine "cancelar"
Set objFSO = Nothing
Set objRead = Nothing

txt6.style.display = "none"
bar.style.backgroundcolor = "rgb(243,64,64)"
txt3.innerHTML = Replace(F1,"000000","8B0000") & "Cancelando Download...</FONT>"

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.GetFile("wget.exe")
WgetLocation = objFile.Path
Set objFSO = Nothing
Set objRead = Nothing

Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")
Set colProcessList = objWMIService.ExecQuery("Select * from Win32_Process Where Name = 'wget.exe'")
For Each objProcess in colProcessList
	Location = objProcess.ExecutablePath
	If Location = WgetLocation Then
	objProcess.Terminate()
	End If
Next
	window.clearTimeout(idTimer)
	idTimer = window.setTimeout("MyTimer2", 2000, "VBScript")
   Exit Function
   End Function
   Function Exit2()
On Error Resume Next
	 D1 = 0
	 D5 = 0
arrCommands = Split(AppUpdaterUI.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Code = arrCommands(3)
   Next
GameName = "0"
If code = "350" Then
GameName = "Dawn of War e Winter Assault"
ElseIf code = "350-3" Then
GameName = "Dawn of War - Dark Crusade"
ElseIf code = "350-4" Then
GameName = "Dawn of War - Soulstorm"
ElseIf code = "356" Then
GameName = "Age of Mythology"
ElseIf code = "356-2" Then
GameName = "Age of Mythology: The Titans Expansion"
ElseIf code = "357" Then
GameName = "Dawn of War II - Retribution"
ElseIf code = "358" Then
GameName = "Dawn of War II e Chaos Rising"
End If
PSP.value = "error"
txt2.innerHTML = F1 & "</FONT>"
If GameName = "0" Then
document.title = "Atualizador da Tradução"
Else
document.title = "Atualizador da Tradução de "&GameName
End If
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBar.log", 1, False)
D1 = objRead.ReadLine
Set objFSO = Nothing
Set objRead = Nothing
D1c = Split(D1, "-")
   For i = 1 to (Ubound(D1c))
	D1 = D1c(1)
	D5 = D1c(2)
   Next
Mode = "update"
Code = "0"
OSversion = VersionOS.value
RestartButtons.style.display = "none"
arrCommands = Split(AppUpdaterUI.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Mode = arrCommands(2)
	Code = arrCommands(3)
   Next
txt6.style.display = "none"
Set objFSO2 = CreateObject("Scripting.FileSystemObject")
Set objRead2 = objFSO2.OpenTextFile("UpdateMode.log", 1, False)
D2 = objRead2.ReadLine
Set objFSO2 = Nothing
Set objRead2 = Nothing
If D2 = "update" Then
	Mode = "update"
ElseIf D2 = "install" Then
	Mode = "install"
Else
	Mode = Mode
End If

If D5 = 21 Then

Set objFSOP = CreateObject("Scripting.FileSystemObject")
Set objReadP = objFSOP.OpenTextFile("UpCoreFCE.log", 1, False)
D1P = objReadP.ReadLine
Set objFSOP = Nothing
Set objReadP = Nothing
D1Pc = Split(D1P, "-")
   For i = 1 to (Ubound(D1Pc))
	UpCoreVersion = D1Pc(1)
   Next
UpCoreVersion = Replace(UpCoreVersion," ","")

Set objFSO = CreateObject("Scripting.FileSystemObject")
If NOT (objFSO.FileExists("RoutineRestart.vbs")) Then
RestartButtons.style.display = "none"
OkB.style.display = "block"
Else
If Code = "0" Then
RestartButtons.style.display = "none"
OkB.style.display = "block"
Else
If UpCoreVersion = "" Then
RestartButtons.style.display = "none"
OkB.style.display = "block"
Else
OkB.style.display = "none"
RestartButtons.style.display = "block"
End If
End If
End If
Set objFSO = Nothing

bar.style.backgroundcolor = "rgb(243,64,64)"
ImageInfo = ImageShow(4)
If OSversion < 609999 Then
InfoImage.style.display = "none"
txt7T.style.marginLeft = "5px"
txt8T.style.marginLeft = "5px"
Else
If ImageInfo = "" Then
InfoImage.style.display = "none"
txt7T.style.marginLeft = "5px"
txt8T.style.marginLeft = "5px"
ElseIf ImageInfo = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABMlBMVEVHcEwAAAAAAAACAgIAAAAFBQUAAAAdGxsAAAAAAAB9Hx4AAAAAAAAAAADDe3oZCQmbe3sAAABaFxYyDg0AAAAAAACqa2uRfn7Pk5OZJSNdGxrYkpEAAACoJSJIExNKHx4cCAitMzGFIyK7dHNZGBgMBQV7IiBqHx3ScW6uPjvYnZylcnKvaGjDgoKnZ2YAAAAEAgFsGxvDgH/Uqqm1eHfJe3iIUE+GMzGrQUA6GBcLAwNkGxubS0qtZGLiop+yammdIyJaGhlSHx4AAACNIiDaJR3riITvnZnDJiLRJR7tk4/ndG/IJSC9JiPwpqPpf3rMJR/ysa7UJR3dLibefnrcYVzst7bXJR30ure0JiTSTkraU064JyXwsa7nbmjfPjfqfnnlZV/dPjfFLyvMNTDRSURS8PFPAAAAVXRSTlMAJQY0LRMZAQx772E+XtEgJYzYvXBXhA/S72DpSfrMRav01ZLer7CH/vT0UKpzqIaZ5dVN1fTBxspYnMKLruXg9rdTKO7////////////////////+Vb828gAAATVJREFUeNp1k9dWwkAURWOKJDEJHRFEpNl77+hyzSRDegQRsJf//wWHN3045/XsO7Nm3zXC/xxaB6WMmBJQdh6f4pcjSUX9Nu+DwD6RRQCU4ziw7d6xOQuADT7e69G+dg+AKh+nNOxnZQBYfDx8/2hAYIuPu29Eh1eUwvD1gZBcIQ2Azb7Le7I0h16RWZv2Sb6oAGB+nfBEy4tIZWphCjh7hoiAJiHDYS0rwW2tsCRh+q4soKx6jLF9bQYCFYexCGrgqfuR50ENPOmR5zlYAxdRcxwfa5iK8P3RhSFioHKZy2tySoBRDNM0FAxkWjfV67qKgbJtU7d7Do9o2ZS6g8Ep/BgWdd3BeNyAps4+J5Of769buIyriIv0n9sQUJoO7/UOvEKU73S93Sng36vKRU0zpb8ifgHeGzVHydMjiQAAAABJRU5ErkJggg==" Then
InfoImage.style.display = "none"
txt7T.style.marginLeft = "5px"
txt8T.style.marginLeft = "5px"
Else
infoimg.src = ImageInfo
InfoImage.style.display = "block"
End If
End If
If Mode = "update" Then
	txt7.innerHTML = F1 & "Atualização não Instalada! Tente Novamente!</FONT>"
	txt8.innerHTML = Replace(F1,"000000","8B0000") & "Erros durante a Atualização!</FONT>"
ElseIf Mode = "install" Then
	txt7.innerHTML = F1 & "Tradução não Instalada! Tente Novamente!</FONT>"
	txt8.innerHTML = Replace(F1,"000000","8B0000") & "Erros durante a Instalação!</FONT>"
End If
	window.clearTimeout(idTimer)

Else

bar.style.backgroundcolor = "rgb(43,194,83)"
ImageInfo = ImageShow(3)
If OSversion < 609999 Then
InfoImage.style.display = "none"
txt7T.style.marginLeft = "5px"
txt8T.style.marginLeft = "5px"
Else
If ImageInfo = "" Then
InfoImage.style.display = "none"
txt7T.style.marginLeft = "5px"
txt8T.style.marginLeft = "5px"
ElseIf ImageInfo = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABMlBMVEVHcEwAAAAAAAACAgIAAAAFBQUAAAAdGxsAAAAAAAB9Hx4AAAAAAAAAAADDe3oZCQmbe3sAAABaFxYyDg0AAAAAAACqa2uRfn7Pk5OZJSNdGxrYkpEAAACoJSJIExNKHx4cCAitMzGFIyK7dHNZGBgMBQV7IiBqHx3ScW6uPjvYnZylcnKvaGjDgoKnZ2YAAAAEAgFsGxvDgH/Uqqm1eHfJe3iIUE+GMzGrQUA6GBcLAwNkGxubS0qtZGLiop+yammdIyJaGhlSHx4AAACNIiDaJR3riITvnZnDJiLRJR7tk4/ndG/IJSC9JiPwpqPpf3rMJR/ysa7UJR3dLibefnrcYVzst7bXJR30ure0JiTSTkraU064JyXwsa7nbmjfPjfqfnnlZV/dPjfFLyvMNTDRSURS8PFPAAAAVXRSTlMAJQY0LRMZAQx772E+XtEgJYzYvXBXhA/S72DpSfrMRav01ZLer7CH/vT0UKpzqIaZ5dVN1fTBxspYnMKLruXg9rdTKO7////////////////////+Vb828gAAATVJREFUeNp1k9dWwkAURWOKJDEJHRFEpNl77+hyzSRDegQRsJf//wWHN3045/XsO7Nm3zXC/xxaB6WMmBJQdh6f4pcjSUX9Nu+DwD6RRQCU4ziw7d6xOQuADT7e69G+dg+AKh+nNOxnZQBYfDx8/2hAYIuPu29Eh1eUwvD1gZBcIQ2Azb7Le7I0h16RWZv2Sb6oAGB+nfBEy4tIZWphCjh7hoiAJiHDYS0rwW2tsCRh+q4soKx6jLF9bQYCFYexCGrgqfuR50ENPOmR5zlYAxdRcxwfa5iK8P3RhSFioHKZy2tySoBRDNM0FAxkWjfV67qKgbJtU7d7Do9o2ZS6g8Ep/BgWdd3BeNyAps4+J5Of769buIyriIv0n9sQUJoO7/UOvEKU73S93Sng36vKRU0zpb8ifgHeGzVHydMjiQAAAABJRU5ErkJggg==" Then
InfoImage.style.display = "none"
txt7T.style.marginLeft = "5px"
txt8T.style.marginLeft = "5px"
Else
infoimg.src = ImageInfo
InfoImage.style.display = "block"
End If
End If
If Mode = "update" Then
	txt7.innerHTML = F1 & "Atualização Instalada!</FONT>"
	txt8.innerHTML = Replace(F1,"000000","008000") & "Tradução Atualizada com Sucesso!</FONT>"
ElseIf Mode = "install" Then
	txt7.innerHTML = F1 & "Tradução Instalada!</FONT>"
	txt8.innerHTML = Replace(F1,"000000","008000") & "Tradução Instalada com Sucesso!</FONT>"
End If
	idTimer = window.setTimeout("CloseTimeout(5)", 1, "VBScript")
	OkB.style.display = "block"
End If
ProgressUI.style.display = "none"
bar.style.backgroundcolor = "#2BC253"
SEPage.style.display = "block"
   Exit Function
   End Function
   Function ExitMSG2(msg)
On Error Resume Next

arrCommands = Split(AppUpdaterUI.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Code = arrCommands(3)
   Next
GameName = "0"
If code = "350" Then
GameName = "Dawn of War e Winter Assault"
ElseIf code = "350-3" Then
GameName = "Dawn of War - Dark Crusade"
ElseIf code = "350-4" Then
GameName = "Dawn of War - Soulstorm"
ElseIf code = "356" Then
GameName = "Age of Mythology"
ElseIf code = "356-2" Then
GameName = "Age of Mythology: The Titans Expansion"
ElseIf code = "357" Then
GameName = "Dawn of War II - Retribution"
ElseIf code = "358" Then
GameName = "Dawn of War II e Chaos Rising"
End If

UIMode.value = "MSG"
timeoutMSG = 0
OSversion = VersionOS.value
RestartButtons.style.display = "none"
If GameName = "0" Then
document.title = "Atualizador da Tradução"
Else
document.title = "Atualizador da Tradução de "&GameName
End If

Code = "0"
arrCommands = Split(AppUpdaterUI.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Code = arrCommands(3)
   Next

If msg = "checkerror" Then
timeoutMSG = 0
ImageInfo = ImageShow(4)
txt7.innerHTML = F1 & "Falha ao validar arquivo</FONT>"
txt8.innerHTML = Replace(F1,"000000","8B0000") & "O arquivo pode estar corrompido!</FONT>"

Set objFSOP = CreateObject("Scripting.FileSystemObject")
Set objReadP = objFSOP.OpenTextFile("UpCoreFCE.log", 1, False)
D1P = objReadP.ReadLine
Set objFSOP = Nothing
Set objReadP = Nothing
D1Pc = Split(D1P, "-")
   For i = 1 to (Ubound(D1Pc))
	UpCoreVersion = D1Pc(1)
   Next
UpCoreVersion = Replace(UpCoreVersion," ","")

Set objFSO = CreateObject("Scripting.FileSystemObject")
If NOT (objFSO.FileExists("RoutineRestart.vbs")) Then
RestartButtons.style.display = "none"
OkB.style.display = "block"
Else
If Code = "0" Then
RestartButtons.style.display = "none"
OkB.style.display = "block"
Else
If UpCoreVersion = "" Then
RestartButtons.style.display = "none"
OkB.style.display = "block"
Else
OkB.style.display = "none"
RestartButtons.style.display = "block"
End If
End If
End If
Set objFSO = Nothing

Else
Exit Function
End If

If OSversion < 609999 Then
InfoImage.style.display = "none"
txt7T.style.marginLeft = "5px"
txt8T.style.marginLeft = "5px"
Else
If ImageInfo = "" Then
InfoImage.style.display = "none"
txt7T.style.marginLeft = "5px"
txt8T.style.marginLeft = "5px"
ElseIf ImageInfo = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABMlBMVEVHcEwAAAAAAAACAgIAAAAFBQUAAAAdGxsAAAAAAAB9Hx4AAAAAAAAAAADDe3oZCQmbe3sAAABaFxYyDg0AAAAAAACqa2uRfn7Pk5OZJSNdGxrYkpEAAACoJSJIExNKHx4cCAitMzGFIyK7dHNZGBgMBQV7IiBqHx3ScW6uPjvYnZylcnKvaGjDgoKnZ2YAAAAEAgFsGxvDgH/Uqqm1eHfJe3iIUE+GMzGrQUA6GBcLAwNkGxubS0qtZGLiop+yammdIyJaGhlSHx4AAACNIiDaJR3riITvnZnDJiLRJR7tk4/ndG/IJSC9JiPwpqPpf3rMJR/ysa7UJR3dLibefnrcYVzst7bXJR30ure0JiTSTkraU064JyXwsa7nbmjfPjfqfnnlZV/dPjfFLyvMNTDRSURS8PFPAAAAVXRSTlMAJQY0LRMZAQx772E+XtEgJYzYvXBXhA/S72DpSfrMRav01ZLer7CH/vT0UKpzqIaZ5dVN1fTBxspYnMKLruXg9rdTKO7////////////////////+Vb828gAAATVJREFUeNp1k9dWwkAURWOKJDEJHRFEpNl77+hyzSRDegQRsJf//wWHN3045/XsO7Nm3zXC/xxaB6WMmBJQdh6f4pcjSUX9Nu+DwD6RRQCU4ziw7d6xOQuADT7e69G+dg+AKh+nNOxnZQBYfDx8/2hAYIuPu29Eh1eUwvD1gZBcIQ2Azb7Le7I0h16RWZv2Sb6oAGB+nfBEy4tIZWphCjh7hoiAJiHDYS0rwW2tsCRh+q4soKx6jLF9bQYCFYexCGrgqfuR50ENPOmR5zlYAxdRcxwfa5iK8P3RhSFioHKZy2tySoBRDNM0FAxkWjfV67qKgbJtU7d7Do9o2ZS6g8Ep/BgWdd3BeNyAps4+J5Of769buIyriIv0n9sQUJoO7/UOvEKU73S93Sng36vKRU0zpb8ifgHeGzVHydMjiQAAAABJRU5ErkJggg==" Then
InfoImage.style.display = "none"
txt7T.style.marginLeft = "5px"
txt8T.style.marginLeft = "5px"
Else
infoimg.src = ImageInfo
InfoImage.style.display = "block"
End If
End If

If timeoutMSG = 1 Then
idTimer = window.setTimeout("CloseTimeout(5)", 1, "VBScript")
Else
window.clearTimeout(idTimer)
End If

ProgressUI.style.display = "none"
bar.style.backgroundcolor = "rgb(43,194,83)"
SEPage.style.display = "block"
   Exit Function
   End Function
   Function RoutineRestart()
On Error Resume Next

Code = "0"
arrCommands = Split(AppUpdaterUI.commandLine, " /:")
   For i = 1 to (Ubound(arrCommands))
	Code = arrCommands(3)
   Next

If Code = "0" Then
idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
Exit Function
End If

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("StatusIS.log", 2, True)
objRead.WriteLine "ready"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("StatusPS.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBarS.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ServerS.log", 2, True)
objRead.WriteLine "1-1"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("StatusPSC.log", 2, True)
objRead.WriteLine "1"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("Status.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("StatusP.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("Server.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("Dsize.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ChangeLogIV.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("UpdateMode.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ServerP.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("ProgressBar.log", 2, True)
objRead.WriteLine "-0-90-"
Set objFSO = Nothing
Set objRead = Nothing

Set objFSOP = CreateObject("Scripting.FileSystemObject")
Set objReadP = objFSOP.OpenTextFile("UpCoreFCE.log", 1, False)
D1P = objReadP.ReadLine
Set objFSOP = Nothing
Set objReadP = Nothing
D1Pc = Split(D1P, "-")
   For i = 1 to (Ubound(D1Pc))
	UpCoreVersion = D1Pc(1)
   Next
UpCoreVersion = Replace(UpCoreVersion," ","")

If UpCoreVersion = "" Then
idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
Exit Function
End If

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objRead = objFSO.OpenTextFile("UpCoreFCE.log", 2, True)
objRead.WriteLine "0"
Set objFSO = Nothing
Set objRead = Nothing

Set objFSO = CreateObject("Scripting.FileSystemObject")
If NOT (objFSO.FileExists("RoutineRestart.vbs")) Then
idTimer = window.setTimeout("MyTimer2", 1, "VBScript")
Exit Function
End If

clreturn.value = 2

Set objWsh = CreateObject("WScript.Shell")
objWsh.Run "RoutineRestart.vbs /Init:Start /code:"& Code &" /upcore:"& UpCoreVersion &" /mode:UI", 0, 0

SEPage.style.display = "none"
Progress.style.display = "none"
ProgressUI.style.display = "block"

BootInit()
   Exit Function
   End Function
   Function CloseTimeout(atime)
On Error Resume Next
OkB.innerHTML = "Ok("&atime&")"
If atime = 0 Then
idTimer = window.setTimeout("MyTimer2", 500, "VBScript")
Else
atime = atime-1
idTimer = window.setTimeout("CloseTimeout("""&atime&""")", 1000, "VBScript")
End If
   Exit Function
   End Function